{"version":3,"file":"126.8027cf8a09fe1a7dfde2.js","mappings":"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","sources":["webpack://@bitwarden/web-vault/./src/app/admin-console/organizations/guards/org-redirect.guard.ts","webpack://@bitwarden/web-vault/./src/app/admin-console/organizations/manage/group-add-edit.component.ts","webpack://@bitwarden/web-vault/./src/app/admin-console/organizations/manage/group-add-edit.component.html","webpack://@bitwarden/web-vault/./src/app/admin-console/organizations/manage/groups.component.html","webpack://@bitwarden/web-vault/./src/app/admin-console/organizations/manage/groups.component.ts","webpack://@bitwarden/web-vault/./src/app/vault/org-vault/vault-filter/vault-filter.service.ts","webpack://@bitwarden/web-vault/./src/app/vault/org-vault/vault-filter/vault-filter.module.ts","webpack://@bitwarden/web-vault/./src/app/vault/individual-vault/attachments.component.html","webpack://@bitwarden/web-vault/./src/app/vault/org-vault/attachments.component.ts","webpack://@bitwarden/web-vault/./src/app/vault/individual-vault/collections.component.html","webpack://@bitwarden/web-vault/./src/app/vault/org-vault/collections.component.ts","webpack://@bitwarden/web-vault/./src/app/vault/individual-vault/vault-filter/components/vault-filter.component.html","webpack://@bitwarden/web-vault/./src/app/vault/org-vault/vault-filter/vault-filter.component.ts","webpack://@bitwarden/web-vault/./src/app/vault/org-vault/vault-header/vault-header.component.html","webpack://@bitwarden/web-vault/./src/app/vault/org-vault/vault-header/vault-header.component.ts","webpack://@bitwarden/web-vault/./src/app/vault/org-vault/vault.component.html","webpack://@bitwarden/web-vault/./src/app/vault/org-vault/vault.component.ts","webpack://@bitwarden/web-vault/./src/app/vault/org-vault/vault-routing.module.ts","webpack://@bitwarden/web-vault/./src/app/vault/org-vault/vault.module.ts","webpack://@bitwarden/web-vault/./src/app/admin-console/organizations/organization-routing.module.ts","webpack://@bitwarden/web-vault/./src/app/admin-console/organizations/organization.module.ts","webpack://@bitwarden/web-vault/../../libs/angular/src/utils/form-selection-list.ts","webpack://@bitwarden/web-vault/./src/app/admin-console/organizations/shared/components/access-selector/user-type.pipe.ts","webpack://@bitwarden/web-vault/./src/app/admin-console/organizations/shared/components/access-selector/access-selector.component.html","webpack://@bitwarden/web-vault/./src/app/admin-console/organizations/shared/components/access-selector/access-selector.component.ts","webpack://@bitwarden/web-vault/./src/app/admin-console/organizations/shared/components/access-selector/access-selector.models.ts","webpack://@bitwarden/web-vault/./src/app/admin-console/organizations/shared/components/access-selector/access-selector.module.ts","webpack://@bitwarden/web-vault/./src/app/admin-console/organizations/shared/components/collection-dialog/collection-dialog.component.ts","webpack://@bitwarden/web-vault/./src/app/admin-console/organizations/shared/components/collection-dialog/collection-dialog.component.html","webpack://@bitwarden/web-vault/../../libs/components/src/form-field/bit-validators/forbidden-characters.validator.ts","webpack://@bitwarden/web-vault/./src/app/admin-console/organizations/shared/components/collection-dialog/collection-dialog.module.ts","webpack://@bitwarden/web-vault/./src/app/admin-console/organizations/shared/shared-organization.module.ts","webpack://@bitwarden/web-vault/../../libs/components/src/multi-select/multi-select.component.html","webpack://@bitwarden/web-vault/../../libs/components/src/multi-select/multi-select.component.ts","webpack://@bitwarden/web-vault/../../libs/components/src/search/search.module.ts","webpack://@bitwarden/web-vault/../../libs/components/src/tabs/tab-group/tab-body.component.ts","webpack://@bitwarden/web-vault/../../libs/components/src/tabs/tab-group/tab-group.component.html","webpack://@bitwarden/web-vault/../../libs/components/src/tabs/tab-group/tab-body.component.html","webpack://@bitwarden/web-vault/../../libs/components/src/tabs/tab-group/tab-group.component.ts","webpack://@bitwarden/web-vault/../../libs/components/src/tabs/tab-group/tab-label.directive.ts","webpack://@bitwarden/web-vault/../../libs/components/src/tabs/tab-group/tab.component.html","webpack://@bitwarden/web-vault/../../libs/components/src/tabs/tab-group/tab.component.ts"],"sourcesContent":["import { Injectable } from \"@angular/core\";\nimport { ActivatedRouteSnapshot, CanActivate, Router, RouterStateSnapshot } from \"@angular/router\";\n\nimport {\n  canAccessOrgAdmin,\n  OrganizationService,\n} from \"@bitwarden/common/admin-console/abstractions/organization/organization.service.abstraction\";\n\n@Injectable({\n  providedIn: \"root\",\n})\nexport class OrganizationRedirectGuard implements CanActivate {\n  constructor(private router: Router, private organizationService: OrganizationService) {}\n\n  async canActivate(route: ActivatedRouteSnapshot, state: RouterStateSnapshot) {\n    const org = this.organizationService.get(route.params.organizationId);\n\n    const customRedirect = route.data?.autoRedirectCallback;\n    if (customRedirect) {\n      let redirectPath = customRedirect(org);\n      if (typeof redirectPath === \"string\") {\n        redirectPath = [redirectPath];\n      }\n      return this.router.createUrlTree([state.url, ...redirectPath]);\n    }\n\n    if (canAccessOrgAdmin(org)) {\n      return this.router.createUrlTree([\"/organizations\", org.id]);\n    }\n    return this.router.createUrlTree([\"/\"]);\n  }\n}\n","import { DIALOG_DATA, DialogConfig, DialogRef } from \"@angular/cdk/dialog\";\nimport { ChangeDetectorRef, Component, Inject, OnDestroy, OnInit } from \"@angular/core\";\nimport { FormBuilder, Validators } from \"@angular/forms\";\nimport { catchError, combineLatest, from, map, of, Subject, switchMap, takeUntil } from \"rxjs\";\n\nimport { DialogServiceAbstraction, SimpleDialogType } from \"@bitwarden/angular/services/dialog\";\nimport { ApiService } from \"@bitwarden/common/abstractions/api.service\";\nimport { I18nService } from \"@bitwarden/common/abstractions/i18n.service\";\nimport { LogService } from \"@bitwarden/common/abstractions/log.service\";\nimport { OrganizationUserService } from \"@bitwarden/common/abstractions/organization-user/organization-user.service\";\nimport { PlatformUtilsService } from \"@bitwarden/common/abstractions/platformUtils.service\";\nimport { CollectionService } from \"@bitwarden/common/admin-console/abstractions/collection.service\";\nimport { CollectionData } from \"@bitwarden/common/admin-console/models/data/collection.data\";\nimport { Collection } from \"@bitwarden/common/admin-console/models/domain/collection\";\nimport { CollectionDetailsResponse } from \"@bitwarden/common/admin-console/models/response/collection.response\";\nimport { ErrorResponse } from \"@bitwarden/common/models/response/error.response\";\n\nimport { GroupService, GroupView } from \"../core\";\nimport {\n  AccessItemType,\n  AccessItemValue,\n  AccessItemView,\n  convertToPermission,\n  convertToSelectionView,\n  PermissionMode,\n} from \"../shared/components/access-selector\";\n\n/**\n * Indices for the available tabs in the dialog\n */\nexport enum GroupAddEditTabType {\n  Info = 0,\n  Members = 1,\n  Collections = 2,\n}\n\nexport interface GroupAddEditDialogParams {\n  /**\n   * ID of the organization the group belongs to\n   */\n  organizationId: string;\n\n  /**\n   * Optional ID of the group being modified\n   */\n  groupId?: string;\n\n  /**\n   * Tab to open when the dialog is open.\n   * Defaults to Group Info\n   */\n  initialTab?: GroupAddEditTabType;\n}\n\nexport enum GroupAddEditDialogResultType {\n  Saved = \"saved\",\n  Canceled = \"canceled\",\n  Deleted = \"deleted\",\n}\n\n/**\n * Strongly typed helper to open a groupAddEditDialog\n * @param dialogService Instance of the dialog service that will be used to open the dialog\n * @param config Configuration for the dialog\n */\nexport const openGroupAddEditDialog = (\n  dialogService: DialogServiceAbstraction,\n  config: DialogConfig<GroupAddEditDialogParams>\n) => {\n  return dialogService.open<GroupAddEditDialogResultType, GroupAddEditDialogParams>(\n    GroupAddEditComponent,\n    config\n  );\n};\n\n@Component({\n  selector: \"app-group-add-edit\",\n  templateUrl: \"group-add-edit.component.html\",\n})\nexport class GroupAddEditComponent implements OnInit, OnDestroy {\n  protected PermissionMode = PermissionMode;\n  protected ResultType = GroupAddEditDialogResultType;\n\n  tabIndex: GroupAddEditTabType;\n  loading = true;\n  editMode = false;\n  title: string;\n  collections: AccessItemView[] = [];\n  members: AccessItemView[] = [];\n  group: GroupView;\n\n  groupForm = this.formBuilder.group({\n    accessAll: [false],\n    name: [\"\", [Validators.required, Validators.maxLength(100)]],\n    externalId: this.formBuilder.control({ value: \"\", disabled: true }),\n    members: [[] as AccessItemValue[]],\n    collections: [[] as AccessItemValue[]],\n  });\n\n  get groupId(): string | undefined {\n    return this.params.groupId;\n  }\n\n  get organizationId(): string {\n    return this.params.organizationId;\n  }\n\n  private destroy$ = new Subject<void>();\n\n  private get orgCollections$() {\n    return from(this.apiService.getCollections(this.organizationId)).pipe(\n      switchMap((response) => {\n        return from(\n          this.collectionService.decryptMany(\n            response.data.map(\n              (r) => new Collection(new CollectionData(r as CollectionDetailsResponse))\n            )\n          )\n        );\n      }),\n      map((collections) =>\n        collections.map<AccessItemView>((c) => ({\n          id: c.id,\n          type: AccessItemType.Collection,\n          labelName: c.name,\n          listName: c.name,\n        }))\n      )\n    );\n  }\n\n  private get orgMembers$() {\n    return from(this.organizationUserService.getAllUsers(this.organizationId)).pipe(\n      map((response) =>\n        response.data.map((m) => ({\n          id: m.id,\n          type: AccessItemType.Member,\n          email: m.email,\n          role: m.type,\n          listName: m.name?.length > 0 ? `${m.name} (${m.email})` : m.email,\n          labelName: m.name || m.email,\n          status: m.status,\n        }))\n      )\n    );\n  }\n\n  private get groupDetails$() {\n    if (!this.editMode) {\n      return of(undefined);\n    }\n\n    return combineLatest([\n      this.groupService.get(this.organizationId, this.groupId),\n      this.apiService.getGroupUsers(this.organizationId, this.groupId),\n    ]).pipe(\n      map(([groupView, users]) => {\n        groupView.members = users;\n        return groupView;\n      }),\n      catchError((e: unknown) => {\n        if (e instanceof ErrorResponse) {\n          this.logService.error(e.message);\n        } else {\n          this.logService.error(e.toString());\n        }\n        return of(undefined);\n      })\n    );\n  }\n\n  constructor(\n    @Inject(DIALOG_DATA) private params: GroupAddEditDialogParams,\n    private dialogRef: DialogRef<GroupAddEditDialogResultType>,\n    private apiService: ApiService,\n    private organizationUserService: OrganizationUserService,\n    private groupService: GroupService,\n    private i18nService: I18nService,\n    private collectionService: CollectionService,\n    private platformUtilsService: PlatformUtilsService,\n    private logService: LogService,\n    private formBuilder: FormBuilder,\n    private changeDetectorRef: ChangeDetectorRef,\n    private dialogService: DialogServiceAbstraction\n  ) {\n    this.tabIndex = params.initialTab ?? GroupAddEditTabType.Info;\n  }\n\n  ngOnInit() {\n    this.editMode = this.loading = this.groupId != null;\n    this.title = this.i18nService.t(this.editMode ? \"editGroup\" : \"newGroup\");\n\n    combineLatest([this.orgCollections$, this.orgMembers$, this.groupDetails$])\n      .pipe(takeUntil(this.destroy$))\n      .subscribe(([collections, members, group]) => {\n        this.collections = collections;\n        this.members = members;\n        this.group = group;\n\n        if (this.group != undefined) {\n          // Must detect changes so that AccessSelector @Inputs() are aware of the latest\n          // collections/members set above, otherwise no selected values will be patched below\n          this.changeDetectorRef.detectChanges();\n\n          this.groupForm.patchValue({\n            name: this.group.name,\n            externalId: this.group.externalId,\n            accessAll: this.group.accessAll,\n            members: this.group.members.map((m) => ({\n              id: m,\n              type: AccessItemType.Member,\n            })),\n            collections: this.group.collections.map((gc) => ({\n              id: gc.id,\n              type: AccessItemType.Collection,\n              permission: convertToPermission(gc),\n            })),\n          });\n        }\n\n        this.loading = false;\n      });\n  }\n\n  ngOnDestroy() {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n\n  submit = async () => {\n    this.groupForm.markAllAsTouched();\n\n    if (this.groupForm.invalid) {\n      if (this.tabIndex !== GroupAddEditTabType.Info) {\n        this.platformUtilsService.showToast(\n          \"error\",\n          null,\n          this.i18nService.t(\"fieldOnTabRequiresAttention\", this.i18nService.t(\"groupInfo\"))\n        );\n      }\n      return;\n    }\n\n    const groupView = new GroupView();\n    groupView.id = this.groupId;\n    groupView.organizationId = this.organizationId;\n\n    const formValue = this.groupForm.value;\n    groupView.name = formValue.name;\n    groupView.accessAll = formValue.accessAll;\n    groupView.members = formValue.members?.map((m) => m.id) ?? [];\n\n    if (!groupView.accessAll) {\n      groupView.collections = formValue.collections.map((c) => convertToSelectionView(c));\n    }\n\n    await this.groupService.save(groupView);\n\n    this.platformUtilsService.showToast(\n      \"success\",\n      null,\n      this.i18nService.t(this.editMode ? \"editedGroupId\" : \"createdGroupId\", formValue.name)\n    );\n\n    this.dialogRef.close(GroupAddEditDialogResultType.Saved);\n  };\n\n  delete = async () => {\n    if (!this.editMode) {\n      return;\n    }\n\n    const confirmed = await this.dialogService.openSimpleDialog({\n      title: this.group.name,\n      content: { key: \"deleteGroupConfirmation\" },\n      type: SimpleDialogType.WARNING,\n    });\n    if (!confirmed) {\n      return false;\n    }\n\n    await this.groupService.delete(this.organizationId, this.groupId);\n\n    this.platformUtilsService.showToast(\n      \"success\",\n      null,\n      this.i18nService.t(\"deletedGroupId\", this.group.name)\n    );\n    this.dialogRef.close(GroupAddEditDialogResultType.Deleted);\n  };\n}\n","<form [formGroup]=\"groupForm\" [bitSubmit]=\"submit\">\n  <bit-dialog [disablePadding]=\"!loading\" dialogSize=\"large\">\n    <span bitDialogTitle>\n      {{ title }}\n      <span *ngIf=\"editMode\" class=\"tw-text-sm tw-normal-case tw-text-muted\">{{\n        group?.name\n      }}</span>\n    </span>\n    <div bitDialogContent>\n      <div *ngIf=\"loading\">\n        <i\n          class=\"bwi bwi-spinner bwi-spin text-muted\"\n          title=\"{{ 'loading' | i18n }}\"\n          aria-hidden=\"true\"\n        ></i>\n        <span class=\"sr-only\">{{ \"loading\" | i18n }}</span>\n      </div>\n\n      <bit-tab-group *ngIf=\"!loading\" [(selectedIndex)]=\"tabIndex\">\n        <bit-tab label=\"{{ 'groupInfo' | i18n }}\">\n          <bit-form-field>\n            <bit-label>{{ \"name\" | i18n }}</bit-label>\n            <input bitInput appAutofocus type=\"text\" formControlName=\"name\" />\n            <bit-hint>{{ \"characterMaximum\" | i18n : 100 }}</bit-hint>\n          </bit-form-field>\n          <bit-form-field>\n            <bit-label>{{ \"externalId\" | i18n }}</bit-label>\n            <input bitInput type=\"text\" formControlName=\"externalId\" />\n            <bit-hint>{{ \"externalIdDesc\" | i18n }}</bit-hint>\n          </bit-form-field>\n        </bit-tab>\n\n        <bit-tab label=\"{{ 'members' | i18n }}\">\n          <p>{{ \"editGroupMembersDesc\" | i18n }}</p>\n          <bit-access-selector\n            formControlName=\"members\"\n            [items]=\"members\"\n            [showMemberRoles]=\"true\"\n            [permissionMode]=\"PermissionMode.Hidden\"\n            [columnHeader]=\"'member' | i18n\"\n            [selectorLabelText]=\"'selectMembers' | i18n\"\n            [emptySelectionText]=\"'noMembersAdded' | i18n\"\n          ></bit-access-selector>\n        </bit-tab>\n\n        <bit-tab label=\"{{ 'collections' | i18n }}\">\n          <p>{{ \"editGroupCollectionsDesc\" | i18n }}</p>\n          <div class=\"tw-my-3\">\n            <input type=\"checkbox\" formControlName=\"accessAll\" id=\"accessAll\" />\n            <label class=\"tw-mb-0 tw-text-lg\" for=\"accessAll\">{{\n              \"accessAllCollectionsDesc\" | i18n\n            }}</label>\n            <p class=\"tw-my-0 tw-text-muted\">{{ \"accessAllCollectionsHelp\" | i18n }}</p>\n          </div>\n          <ng-container *ngIf=\"!groupForm.value.accessAll\">\n            <bit-access-selector\n              formControlName=\"collections\"\n              [items]=\"collections\"\n              [permissionMode]=\"PermissionMode.Edit\"\n              [columnHeader]=\"'collection' | i18n\"\n              [selectorLabelText]=\"'selectCollections' | i18n\"\n              [emptySelectionText]=\"'noCollectionsAdded' | i18n\"\n            ></bit-access-selector>\n          </ng-container>\n        </bit-tab>\n      </bit-tab-group>\n    </div>\n    <ng-container bitDialogFooter>\n      <button bitButton buttonType=\"primary\" bitFormButton type=\"submit\">\n        {{ \"save\" | i18n }}\n      </button>\n      <button\n        bitButton\n        buttonType=\"secondary\"\n        type=\"button\"\n        bitDialogClose\n        [bit-dialog-close]=\"ResultType.Canceled\"\n      >\n        {{ \"cancel\" | i18n }}\n      </button>\n      <button\n        class=\"tw-ml-auto\"\n        type=\"button\"\n        buttonType=\"danger\"\n        bitIconButton=\"bwi-trash\"\n        bitFormButton\n        [bitAction]=\"delete\"\n        [appA11yTitle]=\"'delete' | i18n\"\n      ></button>\n    </ng-container>\n  </bit-dialog>\n</form>\n","<div class=\"container page-content\">\n  <div class=\"tw-mb-4 tw-flex\">\n    <h1>{{ \"groups\" | i18n }}</h1>\n    <div class=\"tw-ml-auto tw-flex tw-items-center\">\n      <div class=\"tw-mr-2\">\n        <label class=\"sr-only\">{{ \"search\" | i18n }}</label>\n        <div class=\"tw-flex tw-items-center\">\n          <i class=\"bwi bwi-search bwi-fw tw-z-20 -tw-mr-7 tw-text-muted\" aria-hidden=\"true\"></i>\n          <input\n            bitInput\n            type=\"search\"\n            placeholder=\"{{ 'searchGroups' | i18n }}\"\n            class=\"tw-rounded-l tw-pl-9\"\n            [(ngModel)]=\"searchText\"\n          />\n        </div>\n      </div>\n      <button bitButton type=\"button\" buttonType=\"primary\" (click)=\"add()\">\n        <i class=\"bwi bwi-plus bwi-fw\" aria-hidden=\"true\"></i>\n        {{ \"newGroup\" | i18n }}\n      </button>\n    </div>\n  </div>\n  <ng-container *ngIf=\"loading\">\n    <i\n      class=\"bwi bwi-spinner bwi-spin text-muted\"\n      title=\"{{ 'loading' | i18n }}\"\n      aria-hidden=\"true\"\n    ></i>\n    <span class=\"sr-only\">{{ \"loading\" | i18n }}</span>\n  </ng-container>\n  <ng-container *ngIf=\"!loading && visibleGroups\">\n    <p *ngIf=\"!visibleGroups.length\">{{ \"noGroupsInList\" | i18n }}</p>\n    <bit-table\n      *ngIf=\"visibleGroups.length\"\n      infinite-scroll\n      [infiniteScrollDistance]=\"1\"\n      [infiniteScrollDisabled]=\"!isPaging()\"\n      (scrolled)=\"loadMore()\"\n    >\n      <ng-container header>\n        <tr>\n          <th bitCell class=\"tw-w-20\">\n            <input\n              type=\"checkbox\"\n              bitCheckbox\n              class=\"tw-mr-2\"\n              (change)=\"toggleAllVisible($event)\"\n              id=\"selectAll\"\n            />\n            <label class=\"tw-mb-0 !tw-font-bold !tw-text-muted\" for=\"selectAll\">{{\n              \"all\" | i18n\n            }}</label>\n          </th>\n          <th bitCell>{{ \"name\" | i18n }}</th>\n          <th bitCell>{{ \"collections\" | i18n }}</th>\n          <th bitCell class=\"tw-w-10\">\n            <button\n              [bitMenuTriggerFor]=\"headerMenu\"\n              type=\"button\"\n              bitIconButton=\"bwi-ellipsis-v\"\n              size=\"small\"\n              appA11yTitle=\"{{ 'options' | i18n }}\"\n            ></button>\n\n            <bit-menu #headerMenu>\n              <button type=\"button\" bitMenuItem (click)=\"deleteAllSelected()\">\n                <span class=\"tw-text-danger\"\n                  ><i aria-hidden=\"true\" class=\"bwi bwi-trash\"></i> {{ \"delete\" | i18n }}</span\n                >\n              </button>\n            </bit-menu>\n          </th>\n        </tr>\n      </ng-container>\n      <ng-template body>\n        <tr bitRow *ngFor=\"let g of visibleGroups\">\n          <td bitCell (click)=\"check(g)\" class=\"tw-cursor-pointer\">\n            <input type=\"checkbox\" bitCheckbox [(ngModel)]=\"g.checked\" />\n          </td>\n          <td bitCell class=\"tw-cursor-pointer tw-font-bold\" (click)=\"edit(g)\">\n            <button type=\"button\" bitLink>\n              {{ g.details.name }}\n            </button>\n          </td>\n          <td bitCell (click)=\"edit(g, ModalTabType.Collections)\" class=\"tw-cursor-pointer\">\n            <bit-badge-list\n              *ngIf=\"!g.details.accessAll\"\n              [items]=\"g.collectionNames\"\n              [maxItems]=\"3\"\n              badgeType=\"secondary\"\n            ></bit-badge-list>\n            <span *ngIf=\"g.details.accessAll\">{{ \"all\" | i18n }}</span>\n          </td>\n          <td bitCell>\n            <button\n              [bitMenuTriggerFor]=\"rowMenu\"\n              type=\"button\"\n              bitIconButton=\"bwi-ellipsis-v\"\n              size=\"small\"\n              appA11yTitle=\"{{ 'options' | i18n }}\"\n            ></button>\n\n            <bit-menu #rowMenu>\n              <button type=\"button\" bitMenuItem (click)=\"edit(g)\">\n                <i aria-hidden=\"true\" class=\"bwi bwi-pencil-square\"></i> {{ \"editInfo\" | i18n }}\n              </button>\n              <button type=\"button\" bitMenuItem (click)=\"edit(g, ModalTabType.Members)\">\n                <i aria-hidden=\"true\" class=\"bwi bwi-user\"></i> {{ \"members\" | i18n }}\n              </button>\n              <button type=\"button\" bitMenuItem (click)=\"edit(g, ModalTabType.Collections)\">\n                <i aria-hidden=\"true\" class=\"bwi bwi-collection\"></i> {{ \"collections\" | i18n }}\n              </button>\n              <button type=\"button\" bitMenuItem (click)=\"delete(g)\">\n                <span class=\"tw-text-danger\"\n                  ><i aria-hidden=\"true\" class=\"bwi bwi-trash\"></i> {{ \"delete\" | i18n }}</span\n                >\n              </button>\n            </bit-menu>\n          </td>\n        </tr>\n      </ng-template>\n    </bit-table>\n  </ng-container>\n  <ng-template #addEdit></ng-template>\n</div>\n","import { Component, OnDestroy, OnInit, ViewChild, ViewContainerRef } from \"@angular/core\";\nimport { ActivatedRoute } from \"@angular/router\";\nimport {\n  BehaviorSubject,\n  combineLatest,\n  concatMap,\n  from,\n  lastValueFrom,\n  map,\n  Subject,\n  switchMap,\n  takeUntil,\n  tap,\n} from \"rxjs\";\nimport { first } from \"rxjs/operators\";\n\nimport { SearchPipe } from \"@bitwarden/angular/pipes/search.pipe\";\nimport { DialogServiceAbstraction, SimpleDialogType } from \"@bitwarden/angular/services/dialog\";\nimport { ModalService } from \"@bitwarden/angular/services/modal.service\";\nimport { ApiService } from \"@bitwarden/common/abstractions/api.service\";\nimport { I18nService } from \"@bitwarden/common/abstractions/i18n.service\";\nimport { LogService } from \"@bitwarden/common/abstractions/log.service\";\nimport { PlatformUtilsService } from \"@bitwarden/common/abstractions/platformUtils.service\";\nimport { SearchService } from \"@bitwarden/common/abstractions/search.service\";\nimport { CollectionService } from \"@bitwarden/common/admin-console/abstractions/collection.service\";\nimport { CollectionData } from \"@bitwarden/common/admin-console/models/data/collection.data\";\nimport { Collection } from \"@bitwarden/common/admin-console/models/domain/collection\";\nimport {\n  CollectionDetailsResponse,\n  CollectionResponse,\n} from \"@bitwarden/common/admin-console/models/response/collection.response\";\nimport { CollectionView } from \"@bitwarden/common/admin-console/models/view/collection.view\";\nimport { Utils } from \"@bitwarden/common/misc/utils\";\nimport { ListResponse } from \"@bitwarden/common/models/response/list.response\";\n\nimport { GroupService, GroupView } from \"../core\";\n\nimport {\n  GroupAddEditDialogResultType,\n  GroupAddEditTabType,\n  openGroupAddEditDialog,\n} from \"./group-add-edit.component\";\n\ntype CollectionViewMap = {\n  [id: string]: CollectionView;\n};\n\ntype GroupDetailsRow = {\n  /**\n   * Group Id (used for searching)\n   */\n  id: string;\n\n  /**\n   * Group name (used for searching)\n   */\n  name: string;\n\n  /**\n   * Details used for displaying group information\n   */\n  details: GroupView;\n\n  /**\n   * True if the group is selected in the table\n   */\n  checked?: boolean;\n\n  /**\n   * A list of collection names the group has access to\n   */\n  collectionNames?: string[];\n};\n\n@Component({\n  selector: \"app-org-groups\",\n  templateUrl: \"groups.component.html\",\n})\nexport class GroupsComponent implements OnInit, OnDestroy {\n  @ViewChild(\"addEdit\", { read: ViewContainerRef, static: true }) addEditModalRef: ViewContainerRef;\n  @ViewChild(\"usersTemplate\", { read: ViewContainerRef, static: true })\n  usersModalRef: ViewContainerRef;\n\n  loading = true;\n  organizationId: string;\n  groups: GroupDetailsRow[];\n\n  protected didScroll = false;\n  protected pageSize = 100;\n  protected ModalTabType = GroupAddEditTabType;\n\n  private pagedGroupsCount = 0;\n  private pagedGroups: GroupDetailsRow[];\n  private searchedGroups: GroupDetailsRow[];\n  private _searchText: string;\n  private destroy$ = new Subject<void>();\n  private refreshGroups$ = new BehaviorSubject<void>(null);\n\n  get searchText() {\n    return this._searchText;\n  }\n  set searchText(value: string) {\n    this._searchText = value;\n    // Manually update as we are not using the search pipe in the template\n    this.updateSearchedGroups();\n  }\n\n  /**\n   * The list of groups that should be visible in the table.\n   * This is needed as there are two modes (paging/searching) and\n   * we need a reference to the currently visible groups for\n   * the Select All checkbox\n   */\n  get visibleGroups(): GroupDetailsRow[] {\n    if (this.isPaging()) {\n      return this.pagedGroups;\n    }\n    if (this.isSearching()) {\n      return this.searchedGroups;\n    }\n    return this.groups;\n  }\n\n  constructor(\n    private apiService: ApiService,\n    private groupService: GroupService,\n    private route: ActivatedRoute,\n    private i18nService: I18nService,\n    private modalService: ModalService,\n    private dialogService: DialogServiceAbstraction,\n    private platformUtilsService: PlatformUtilsService,\n    private searchService: SearchService,\n    private logService: LogService,\n    private collectionService: CollectionService,\n    private searchPipe: SearchPipe\n  ) {}\n\n  async ngOnInit() {\n    this.route.params\n      .pipe(\n        tap((params) => (this.organizationId = params.organizationId)),\n        switchMap(() =>\n          combineLatest([\n            // collectionMap\n            from(this.apiService.getCollections(this.organizationId)).pipe(\n              concatMap((response) => this.toCollectionMap(response))\n            ),\n            // groups\n            this.refreshGroups$.pipe(\n              switchMap(() => this.groupService.getAll(this.organizationId))\n            ),\n          ])\n        ),\n        map(([collectionMap, groups]) => {\n          return groups\n            .sort(Utils.getSortFunction(this.i18nService, \"name\"))\n            .map<GroupDetailsRow>((g) => ({\n              id: g.id,\n              name: g.name,\n              details: g,\n              checked: false,\n              collectionNames: g.collections\n                .map((c) => collectionMap[c.id]?.name)\n                .sort(this.i18nService.collator?.compare),\n            }));\n        }),\n        takeUntil(this.destroy$)\n      )\n      .subscribe((groups) => {\n        this.groups = groups;\n        this.resetPaging();\n        this.updateSearchedGroups();\n        this.loading = false;\n      });\n\n    this.route.queryParams\n      .pipe(\n        first(),\n        concatMap(async (qParams) => {\n          this.searchText = qParams.search;\n        }),\n        takeUntil(this.destroy$)\n      )\n      .subscribe();\n  }\n\n  ngOnDestroy() {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n\n  loadMore() {\n    if (!this.groups || this.groups.length <= this.pageSize) {\n      return;\n    }\n    const pagedLength = this.pagedGroups.length;\n    let pagedSize = this.pageSize;\n    if (pagedLength === 0 && this.pagedGroupsCount > this.pageSize) {\n      pagedSize = this.pagedGroupsCount;\n    }\n    if (this.groups.length > pagedLength) {\n      this.pagedGroups = this.pagedGroups.concat(\n        this.groups.slice(pagedLength, pagedLength + pagedSize)\n      );\n    }\n    this.pagedGroupsCount = this.pagedGroups.length;\n    this.didScroll = this.pagedGroups.length > this.pageSize;\n  }\n\n  async edit(\n    group: GroupDetailsRow,\n    startingTabIndex: GroupAddEditTabType = GroupAddEditTabType.Info\n  ) {\n    const dialogRef = openGroupAddEditDialog(this.dialogService, {\n      data: {\n        initialTab: startingTabIndex,\n        organizationId: this.organizationId,\n        groupId: group != null ? group.details.id : null,\n      },\n    });\n\n    const result = await lastValueFrom(dialogRef.closed);\n\n    if (result == GroupAddEditDialogResultType.Saved) {\n      this.refreshGroups$.next();\n    } else if (result == GroupAddEditDialogResultType.Deleted) {\n      this.removeGroup(group.details.id);\n    }\n  }\n\n  add() {\n    this.edit(null);\n  }\n\n  async delete(groupRow: GroupDetailsRow) {\n    const confirmed = await this.dialogService.openSimpleDialog({\n      title: groupRow.details.name,\n      content: { key: \"deleteGroupConfirmation\" },\n      type: SimpleDialogType.WARNING,\n    });\n    if (!confirmed) {\n      return false;\n    }\n\n    try {\n      await this.groupService.delete(this.organizationId, groupRow.details.id);\n      this.platformUtilsService.showToast(\n        \"success\",\n        null,\n        this.i18nService.t(\"deletedGroupId\", groupRow.details.name)\n      );\n      this.removeGroup(groupRow.details.id);\n    } catch (e) {\n      this.logService.error(e);\n    }\n  }\n\n  async deleteAllSelected() {\n    const groupsToDelete = this.groups.filter((g) => g.checked);\n\n    if (groupsToDelete.length == 0) {\n      return;\n    }\n\n    const deleteMessage = groupsToDelete.map((g) => g.details.name).join(\", \");\n    const confirmed = await this.dialogService.openSimpleDialog({\n      title: {\n        key: \"deleteMultipleGroupsConfirmation\",\n        placeholders: [groupsToDelete.length.toString()],\n      },\n      content: deleteMessage,\n      type: SimpleDialogType.WARNING,\n    });\n    if (!confirmed) {\n      return false;\n    }\n\n    try {\n      await this.groupService.deleteMany(\n        this.organizationId,\n        groupsToDelete.map((g) => g.details.id)\n      );\n      this.platformUtilsService.showToast(\n        \"success\",\n        null,\n        this.i18nService.t(\"deletedManyGroups\", groupsToDelete.length.toString())\n      );\n\n      groupsToDelete.forEach((g) => this.removeGroup(g.details.id));\n    } catch (e) {\n      this.logService.error(e);\n    }\n  }\n\n  resetPaging() {\n    this.pagedGroups = [];\n    this.loadMore();\n  }\n\n  isSearching() {\n    return this.searchService.isSearchable(this.searchText);\n  }\n\n  check(groupRow: GroupDetailsRow) {\n    groupRow.checked = !groupRow.checked;\n  }\n\n  toggleAllVisible(event: Event) {\n    this.visibleGroups.forEach((g) => (g.checked = (event.target as HTMLInputElement).checked));\n  }\n\n  isPaging() {\n    const searching = this.isSearching();\n    if (searching && this.didScroll) {\n      this.resetPaging();\n    }\n    return !searching && this.groups && this.groups.length > this.pageSize;\n  }\n\n  private removeGroup(id: string) {\n    const index = this.groups.findIndex((g) => g.details.id === id);\n    if (index > -1) {\n      this.groups.splice(index, 1);\n      this.resetPaging();\n      this.updateSearchedGroups();\n    }\n  }\n\n  private async toCollectionMap(response: ListResponse<CollectionResponse>) {\n    const collections = response.data.map(\n      (r) => new Collection(new CollectionData(r as CollectionDetailsResponse))\n    );\n    const decryptedCollections = await this.collectionService.decryptMany(collections);\n\n    // Convert to an object using collection Ids as keys for faster name lookups\n    const collectionMap: CollectionViewMap = {};\n    decryptedCollections.forEach((c) => (collectionMap[c.id] = c));\n\n    return collectionMap;\n  }\n\n  private updateSearchedGroups() {\n    if (this.searchService.isSearchable(this.searchText)) {\n      // Making use of the pipe in the component as we need know which groups where filtered\n      this.searchedGroups = this.searchPipe.transform(\n        this.groups,\n        this.searchText,\n        (group) => group.details.name,\n        (group) => group.details.id\n      );\n    }\n  }\n}\n","import { Injectable, OnDestroy } from \"@angular/core\";\nimport { map, Observable, ReplaySubject, Subject } from \"rxjs\";\n\nimport { I18nService } from \"@bitwarden/common/abstractions/i18n.service\";\nimport { OrganizationService } from \"@bitwarden/common/admin-console/abstractions/organization/organization.service.abstraction\";\nimport { PolicyService } from \"@bitwarden/common/admin-console/abstractions/policy/policy.service.abstraction\";\nimport { TreeNode } from \"@bitwarden/common/models/domain/tree-node\";\nimport { CipherService } from \"@bitwarden/common/vault/abstractions/cipher.service\";\nimport { FolderService } from \"@bitwarden/common/vault/abstractions/folder/folder.service.abstraction\";\n\nimport {\n  CollectionAdminService,\n  CollectionAdminView,\n} from \"../../../admin-console/organizations/core\";\nimport { StateService } from \"../../../core\";\nimport { VaultFilterService as BaseVaultFilterService } from \"../../individual-vault/vault-filter/services/vault-filter.service\";\nimport { CollectionFilter } from \"../../individual-vault/vault-filter/shared/models/vault-filter.type\";\n\n@Injectable()\nexport class VaultFilterService extends BaseVaultFilterService implements OnDestroy {\n  private destroy$ = new Subject<void>();\n  private _collections = new ReplaySubject<CollectionAdminView[]>(1);\n\n  filteredCollections$: Observable<CollectionAdminView[]> = this._collections.asObservable();\n\n  collectionTree$: Observable<TreeNode<CollectionFilter>> = this.filteredCollections$.pipe(\n    map((collections) => this.buildCollectionTree(collections))\n  );\n\n  constructor(\n    stateService: StateService,\n    organizationService: OrganizationService,\n    folderService: FolderService,\n    cipherService: CipherService,\n    policyService: PolicyService,\n    i18nService: I18nService,\n    protected collectionAdminService: CollectionAdminService\n  ) {\n    super(\n      stateService,\n      organizationService,\n      folderService,\n      cipherService,\n      policyService,\n      i18nService\n    );\n  }\n\n  async reloadCollections(collections: CollectionAdminView[]) {\n    this._collections.next(collections);\n  }\n\n  ngOnDestroy() {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n}\n","import { NgModule } from \"@angular/core\";\n\nimport { VaultFilterService as VaultFilterServiceAbstraction } from \"../../individual-vault/vault-filter/services/abstractions/vault-filter.service\";\nimport { VaultFilterSharedModule } from \"../../individual-vault/vault-filter/shared/vault-filter-shared.module\";\n\nimport { VaultFilterComponent } from \"./vault-filter.component\";\nimport { VaultFilterService } from \"./vault-filter.service\";\n\n@NgModule({\n  imports: [VaultFilterSharedModule],\n  declarations: [VaultFilterComponent],\n  exports: [VaultFilterComponent],\n  providers: [\n    {\n      provide: VaultFilterServiceAbstraction,\n      useClass: VaultFilterService,\n    },\n  ],\n})\nexport class VaultFilterModule {}\n","<div class=\"modal fade\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"attachmentsTitle\">\n  <div class=\"modal-dialog modal-dialog-scrollable\" role=\"document\">\n    <form\n      class=\"modal-content\"\n      #form\n      (ngSubmit)=\"submit()\"\n      [appApiAction]=\"formPromise\"\n      ngNativeValidate\n    >\n      <div class=\"modal-header\">\n        <h1 class=\"modal-title\" id=\"attachmentsTitle\">\n          {{ \"attachments\" | i18n }}\n          <small *ngIf=\"cipher\">{{ cipher.name }}</small>\n        </h1>\n        <button\n          type=\"button\"\n          class=\"close\"\n          data-dismiss=\"modal\"\n          appA11yTitle=\"{{ 'close' | i18n }}\"\n        >\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <table class=\"table table-hover table-list\" *ngIf=\"cipher && cipher.hasAttachments\">\n          <tbody>\n            <tr *ngFor=\"let a of cipher.attachments\">\n              <td class=\"table-list-icon\">\n                <i\n                  class=\"bwi bwi-fw bwi-lg bwi-file\"\n                  *ngIf=\"!$any(a).downloading\"\n                  aria-hidden=\"true\"\n                ></i>\n                <i\n                  class=\"bwi bwi-spinner bwi-lg bwi-fw bwi-spin\"\n                  *ngIf=\"$any(a).downloading\"\n                  aria-hidden=\"true\"\n                ></i>\n              </td>\n              <td class=\"wrap\">\n                <div class=\"d-flex\">\n                  <a href=\"#\" appStopClick (click)=\"download(a)\">{{ a.fileName }}</a>\n                  <div *ngIf=\"showFixOldAttachments(a)\" class=\"ml-2\">\n                    <a\n                      href=\"https://bitwarden.com/help/attachments/#fixing-old-attachments\"\n                      target=\"_blank\"\n                      rel=\"noopener\"\n                    >\n                      <i\n                        class=\"bwi bwi-exclamation-triangle text-warning\"\n                        title=\"{{ 'attachmentFixDesc' | i18n }}\"\n                        aria-hidden=\"true\"\n                      ></i>\n                      <span class=\"sr-only\">{{ \"attachmentFixDesc\" | i18n }}</span></a\n                    >\n                    <button\n                      type=\"button\"\n                      class=\"btn btn-outline-primary btn-sm m-0 py-0 px-2\"\n                      (click)=\"reupload(a)\"\n                      #reuploadBtn\n                      [appApiAction]=\"reuploadPromises[a.id]\"\n                      [disabled]=\"$any(reuploadBtn).loading\"\n                    >\n                      {{ \"fix\" | i18n }}\n                    </button>\n                  </div>\n                </div>\n                <small>{{ a.sizeName }}</small>\n              </td>\n              <td class=\"table-list-options\" *ngIf=\"!viewOnly\">\n                <button\n                  class=\"btn btn-outline-danger\"\n                  type=\"button\"\n                  appStopClick\n                  appA11yTitle=\"{{ 'delete' | i18n }}\"\n                  (click)=\"delete(a)\"\n                  #deleteBtn\n                  [appApiAction]=\"deletePromises[a.id]\"\n                  [disabled]=\"$any(deleteBtn).loading\"\n                >\n                  <i\n                    class=\"bwi bwi-trash bwi-lg bwi-fw\"\n                    [hidden]=\"$any(deleteBtn).loading\"\n                    aria-hidden=\"true\"\n                  ></i>\n                  <i\n                    class=\"bwi bwi-spinner bwi-spin bwi-lg bwi-fw\"\n                    [hidden]=\"!$any(deleteBtn).loading\"\n                    title=\"{{ 'loading' | i18n }}\"\n                    aria-hidden=\"true\"\n                  ></i>\n                </button>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        <div *ngIf=\"!viewOnly\">\n          <h3>{{ \"newAttachment\" | i18n }}</h3>\n          <label for=\"file\" class=\"sr-only\">{{ \"file\" | i18n }}</label>\n          <input type=\"file\" id=\"file\" class=\"form-control-file\" name=\"file\" required />\n          <small class=\"form-text text-muted\">{{ \"maxFileSize\" | i18n }}</small>\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button\n          type=\"submit\"\n          class=\"btn btn-primary btn-submit\"\n          [disabled]=\"form.loading\"\n          *ngIf=\"!viewOnly\"\n        >\n          <i class=\"bwi bwi-spinner bwi-spin\" title=\"{{ 'loading' | i18n }}\" aria-hidden=\"true\"></i>\n          <span>{{ \"save\" | i18n }}</span>\n        </button>\n        <button type=\"button\" class=\"btn btn-outline-secondary\" data-dismiss=\"modal\">\n          {{ \"close\" | i18n }}\n        </button>\n      </div>\n    </form>\n  </div>\n</div>\n","import { Component } from \"@angular/core\";\n\nimport { DialogServiceAbstraction } from \"@bitwarden/angular/services/dialog\";\nimport { ApiService } from \"@bitwarden/common/abstractions/api.service\";\nimport { CryptoService } from \"@bitwarden/common/abstractions/crypto.service\";\nimport { FileDownloadService } from \"@bitwarden/common/abstractions/fileDownload/fileDownload.service\";\nimport { I18nService } from \"@bitwarden/common/abstractions/i18n.service\";\nimport { LogService } from \"@bitwarden/common/abstractions/log.service\";\nimport { PlatformUtilsService } from \"@bitwarden/common/abstractions/platformUtils.service\";\nimport { StateService } from \"@bitwarden/common/abstractions/state.service\";\nimport { Organization } from \"@bitwarden/common/admin-console/models/domain/organization\";\nimport { CipherService } from \"@bitwarden/common/vault/abstractions/cipher.service\";\nimport { CipherData } from \"@bitwarden/common/vault/models/data/cipher.data\";\nimport { Cipher } from \"@bitwarden/common/vault/models/domain/cipher\";\nimport { AttachmentView } from \"@bitwarden/common/vault/models/view/attachment.view\";\n\nimport { AttachmentsComponent as BaseAttachmentsComponent } from \"../individual-vault/attachments.component\";\n\n@Component({\n  selector: \"app-org-vault-attachments\",\n  templateUrl: \"../individual-vault/attachments.component.html\",\n})\nexport class AttachmentsComponent extends BaseAttachmentsComponent {\n  viewOnly = false;\n  organization: Organization;\n\n  constructor(\n    cipherService: CipherService,\n    i18nService: I18nService,\n    cryptoService: CryptoService,\n    stateService: StateService,\n    platformUtilsService: PlatformUtilsService,\n    apiService: ApiService,\n    logService: LogService,\n    fileDownloadService: FileDownloadService,\n    dialogService: DialogServiceAbstraction\n  ) {\n    super(\n      cipherService,\n      i18nService,\n      cryptoService,\n      stateService,\n      platformUtilsService,\n      apiService,\n      logService,\n      fileDownloadService,\n      dialogService\n    );\n  }\n\n  protected async reupload(attachment: AttachmentView) {\n    if (this.organization.canEditAnyCollection && this.showFixOldAttachments(attachment)) {\n      await super.reuploadCipherAttachment(attachment, true);\n    }\n  }\n\n  protected async loadCipher() {\n    if (!this.organization.canEditAnyCollection) {\n      return await super.loadCipher();\n    }\n    const response = await this.apiService.getCipherAdmin(this.cipherId);\n    return new Cipher(new CipherData(response));\n  }\n\n  protected saveCipherAttachment(file: File) {\n    return this.cipherService.saveAttachmentWithServer(\n      this.cipherDomain,\n      file,\n      this.organization.canEditAnyCollection\n    );\n  }\n\n  protected deleteCipherAttachment(attachmentId: string) {\n    if (!this.organization.canEditAnyCollection) {\n      return super.deleteCipherAttachment(attachmentId);\n    }\n    return this.apiService.deleteCipherAttachmentAdmin(this.cipherId, attachmentId);\n  }\n\n  protected showFixOldAttachments(attachment: AttachmentView) {\n    return attachment.key == null && this.organization.canEditAnyCollection;\n  }\n}\n","<div class=\"modal fade\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"collectionsTitle\">\n  <div class=\"modal-dialog modal-dialog-scrollable\" role=\"document\">\n    <form class=\"modal-content\" #form (ngSubmit)=\"submit()\" [appApiAction]=\"formPromise\">\n      <div class=\"modal-header\">\n        <h1 class=\"modal-title\" id=\"collectionsTitle\">\n          {{ \"collections\" | i18n }}\n          <small *ngIf=\"cipher\">{{ cipher.name }}</small>\n        </h1>\n        <button\n          type=\"button\"\n          class=\"close\"\n          data-dismiss=\"modal\"\n          appA11yTitle=\"{{ 'close' | i18n }}\"\n        >\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <p>{{ \"collectionsDesc\" | i18n }}</p>\n        <div class=\"d-flex\">\n          <h3>{{ \"collections\" | i18n }}</h3>\n          <div class=\"ml-auto d-flex\" *ngIf=\"collections && collections.length\">\n            <button type=\"button\" (click)=\"selectAll(true)\" class=\"btn btn-link btn-sm py-0\">\n              {{ \"selectAll\" | i18n }}\n            </button>\n            <button type=\"button\" (click)=\"selectAll(false)\" class=\"btn btn-link btn-sm py-0\">\n              {{ \"unselectAll\" | i18n }}\n            </button>\n          </div>\n        </div>\n        <div *ngIf=\"!collections || !collections.length\">\n          {{ \"noCollectionsInList\" | i18n }}\n        </div>\n        <table class=\"table table-hover table-list mb-0\" *ngIf=\"collections && collections.length\">\n          <tbody>\n            <tr *ngFor=\"let c of collections; let i = index\" (click)=\"check(c)\">\n              <td class=\"table-list-checkbox\">\n                <input\n                  type=\"checkbox\"\n                  [(ngModel)]=\"$any(c).checked\"\n                  name=\"Collection[{{ i }}].Checked\"\n                  appStopProp\n                />\n              </td>\n              <td>\n                {{ c.name }}\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"submit\" class=\"btn btn-primary btn-submit\" [disabled]=\"form.loading\">\n          <i class=\"bwi bwi-spinner bwi-spin\" title=\"{{ 'loading' | i18n }}\" aria-hidden=\"true\"></i>\n          <span>{{ \"save\" | i18n }}</span>\n        </button>\n        <button type=\"button\" class=\"btn btn-outline-secondary\" data-dismiss=\"modal\">\n          {{ \"cancel\" | i18n }}\n        </button>\n      </div>\n    </form>\n  </div>\n</div>\n","import { Component } from \"@angular/core\";\n\nimport { ApiService } from \"@bitwarden/common/abstractions/api.service\";\nimport { I18nService } from \"@bitwarden/common/abstractions/i18n.service\";\nimport { LogService } from \"@bitwarden/common/abstractions/log.service\";\nimport { PlatformUtilsService } from \"@bitwarden/common/abstractions/platformUtils.service\";\nimport { CollectionService } from \"@bitwarden/common/admin-console/abstractions/collection.service\";\nimport { Organization } from \"@bitwarden/common/admin-console/models/domain/organization\";\nimport { CipherService } from \"@bitwarden/common/vault/abstractions/cipher.service\";\nimport { CipherData } from \"@bitwarden/common/vault/models/data/cipher.data\";\nimport { Cipher } from \"@bitwarden/common/vault/models/domain/cipher\";\nimport { CipherCollectionsRequest } from \"@bitwarden/common/vault/models/request/cipher-collections.request\";\n\nimport { CollectionsComponent as BaseCollectionsComponent } from \"../individual-vault/collections.component\";\n\n@Component({\n  selector: \"app-org-vault-collections\",\n  templateUrl: \"../../vault/individual-vault/collections.component.html\",\n})\nexport class CollectionsComponent extends BaseCollectionsComponent {\n  organization: Organization;\n\n  constructor(\n    collectionService: CollectionService,\n    platformUtilsService: PlatformUtilsService,\n    i18nService: I18nService,\n    cipherService: CipherService,\n    private apiService: ApiService,\n    logService: LogService\n  ) {\n    super(collectionService, platformUtilsService, i18nService, cipherService, logService);\n    this.allowSelectNone = true;\n  }\n\n  protected async loadCipher() {\n    if (!this.organization.canViewAllCollections) {\n      return await super.loadCipher();\n    }\n    const response = await this.apiService.getCipherAdmin(this.cipherId);\n    return new Cipher(new CipherData(response));\n  }\n\n  protected loadCipherCollections() {\n    if (!this.organization.canViewAllCollections) {\n      return super.loadCipherCollections();\n    }\n    return this.collectionIds;\n  }\n\n  protected loadCollections() {\n    if (!this.organization.canViewAllCollections) {\n      return super.loadCollections();\n    }\n    return Promise.resolve(this.collections);\n  }\n\n  protected saveCollections() {\n    if (this.organization.canEditAnyCollection) {\n      const request = new CipherCollectionsRequest(this.cipherDomain.collectionIds);\n      return this.apiService.putCipherCollectionsAdmin(this.cipherId, request);\n    } else {\n      return super.saveCollections();\n    }\n  }\n}\n","<div class=\"card vault-filters\">\n  <div class=\"container loading-spinner\" *ngIf=\"!isLoaded\">\n    <i class=\"bwi bwi-spinner bwi-spin bwi-3x\" aria-hidden=\"true\"></i>\n  </div>\n  <div *ngIf=\"isLoaded\">\n    <div class=\"card-header d-flex\">\n      {{ \"filters\" | i18n }}\n      <a\n        class=\"ml-auto\"\n        href=\"https://bitwarden.com/help/searching-vault/\"\n        target=\"_blank\"\n        rel=\"noopener\"\n        appA11yTitle=\"{{ 'learnMore' | i18n }}\"\n      >\n        <i class=\"bwi bwi-question-circle\" aria-hidden=\"true\"></i>\n      </a>\n    </div>\n    <div class=\"card-body\">\n      <input\n        type=\"search\"\n        placeholder=\"{{ searchPlaceholder | i18n }}\"\n        id=\"search\"\n        class=\"form-control\"\n        [ngModel]=\"searchText\"\n        (ngModelChange)=\"onSearchTextChanged($event)\"\n        autocomplete=\"off\"\n        appAutofocus\n      />\n      <ng-container *ngFor=\"let f of filtersList\">\n        <div class=\"filter\">\n          <app-filter-section [activeFilter]=\"activeFilter\" [section]=\"f\"> </app-filter-section>\n        </div>\n      </ng-container>\n    </div>\n  </div>\n</div>\n","import { Component, Input, OnDestroy, OnInit } from \"@angular/core\";\nimport { firstValueFrom, Subject } from \"rxjs\";\n\nimport { Organization } from \"@bitwarden/common/admin-console/models/domain/organization\";\nimport { TreeNode } from \"@bitwarden/common/models/domain/tree-node\";\n\nimport { VaultFilterComponent as BaseVaultFilterComponent } from \"../../individual-vault/vault-filter/components/vault-filter.component\"; //../../vault/vault-filter/components/vault-filter.component\";\nimport {\n  VaultFilterList,\n  VaultFilterType,\n} from \"../../individual-vault/vault-filter/shared/models/vault-filter-section.type\";\nimport { CollectionFilter } from \"../../individual-vault/vault-filter/shared/models/vault-filter.type\";\n\n@Component({\n  selector: \"app-organization-vault-filter\",\n  templateUrl: \"../../individual-vault/vault-filter/components/vault-filter.component.html\",\n})\nexport class VaultFilterComponent extends BaseVaultFilterComponent implements OnInit, OnDestroy {\n  @Input() set organization(value: Organization) {\n    if (value && value !== this._organization) {\n      this._organization = value;\n      this.vaultFilterService.setOrganizationFilter(this._organization);\n    }\n  }\n  _organization: Organization;\n  protected destroy$: Subject<void>;\n\n  async ngOnInit() {\n    this.filters = await this.buildAllFilters();\n    if (!this.activeFilter.selectedCipherTypeNode) {\n      this.activeFilter.resetFilter();\n      this.activeFilter.selectedCollectionNode =\n        (await this.getDefaultFilter()) as TreeNode<CollectionFilter>;\n    }\n    this.isLoaded = true;\n  }\n\n  ngOnDestroy() {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n\n  async buildAllFilters(): Promise<VaultFilterList> {\n    const builderFilter = {} as VaultFilterList;\n    builderFilter.typeFilter = await this.addTypeFilter([\"favorites\"]);\n    builderFilter.collectionFilter = await this.addCollectionFilter();\n    builderFilter.trashFilter = await this.addTrashFilter();\n    return builderFilter;\n  }\n\n  async getDefaultFilter(): Promise<TreeNode<VaultFilterType>> {\n    return await firstValueFrom(this.filters?.collectionFilter.data$);\n  }\n}\n","<div class=\"tw-mb-4 tw-flex tw-items-start tw-justify-between\">\n  <div>\n    <bit-breadcrumbs *ngIf=\"showBreadcrumbs\">\n      <bit-breadcrumb\n        [route]=\"[]\"\n        [queryParams]=\"{ organizationId: organization.id, collectionId: null }\"\n        queryParamsHandling=\"merge\"\n      >\n        {{ organization.name }} {{ \"vault\" | i18n | lowercase }}\n      </bit-breadcrumb>\n      <ng-container>\n        <bit-breadcrumb\n          *ngFor=\"let collection of collections\"\n          icon=\"bwi-collection\"\n          [route]=\"[]\"\n          [queryParams]=\"{ collectionId: collection.id }\"\n          queryParamsHandling=\"merge\"\n        >\n          {{ collection.name }}\n        </bit-breadcrumb>\n      </ng-container>\n    </bit-breadcrumbs>\n    <h1 class=\"tw-mb-0 tw-mt-1 tw-flex tw-items-center tw-space-x-2\">\n      <i\n        *ngIf=\"filter.collectionId !== undefined\"\n        class=\"bwi bwi-collection\"\n        aria-hidden=\"true\"\n      ></i>\n      <span>{{ title }}</span>\n      <ng-container *ngIf=\"collection !== undefined && (canEditCollection || canDeleteCollection)\">\n        <button\n          bitIconButton=\"bwi-angle-down\"\n          [bitMenuTriggerFor]=\"editCollectionMenu\"\n          size=\"small\"\n          type=\"button\"\n          aria-haspopup\n        ></button>\n        <bit-menu #editCollectionMenu>\n          <button\n            type=\"button\"\n            *ngIf=\"canEditCollection\"\n            bitMenuItem\n            (click)=\"editCollection(CollectionDialogTabType.Info)\"\n          >\n            <i class=\"bwi bwi-fw bwi-pencil-square\" aria-hidden=\"true\"></i>\n            {{ \"editInfo\" | i18n }}\n          </button>\n          <button\n            type=\"button\"\n            *ngIf=\"canEditCollection\"\n            bitMenuItem\n            (click)=\"editCollection(CollectionDialogTabType.Access)\"\n          >\n            <i class=\"bwi bwi-fw bwi-users\" aria-hidden=\"true\"></i>\n            {{ \"access\" | i18n }}\n          </button>\n          <button\n            type=\"button\"\n            *ngIf=\"canDeleteCollection\"\n            bitMenuItem\n            (click)=\"deleteCollection()\"\n          >\n            <span class=\"tw-text-danger\">\n              <i class=\"bwi bwi-fw bwi-trash\" aria-hidden=\"true\"></i>\n              {{ \"delete\" | i18n }}\n            </span>\n          </button>\n        </bit-menu>\n      </ng-container>\n      <small *ngIf=\"loading\">\n        <i\n          class=\"bwi bwi-spinner bwi-spin text-muted\"\n          title=\"{{ 'loading' | i18n }}\"\n          aria-hidden=\"true\"\n        ></i>\n        <span class=\"tw-sr-only\">{{ \"loading\" | i18n }}</span>\n      </small>\n    </h1>\n  </div>\n\n  <div *ngIf=\"filter.type !== 'trash' && filter.collectionId !== Unassigned\" class=\"tw-shrink-0\">\n    <div *ngIf=\"organization.canCreateNewCollections\" appListDropdown>\n      <button\n        bitButton\n        buttonType=\"primary\"\n        type=\"button\"\n        [bitMenuTriggerFor]=\"addOptions\"\n        id=\"newItemDropdown\"\n        appA11yTitle=\"{{ 'new' | i18n }}\"\n      >\n        {{ \"new\" | i18n }}<i class=\"bwi bwi-angle-down tw-ml-2\" aria-hidden=\"true\"></i>\n      </button>\n      <bit-menu #addOptions aria-labelledby=\"newItemDropdown\">\n        <button type=\"button\" bitMenuItem (click)=\"addCipher()\">\n          <i class=\"bwi bwi-fw bwi-globe\" aria-hidden=\"true\"></i>\n          {{ \"item\" | i18n }}\n        </button>\n        <button type=\"button\" bitMenuItem (click)=\"addCollection()\">\n          <i class=\"bwi bwi-fw bwi-collection\" aria-hidden=\"true\"></i>\n          {{ \"collection\" | i18n }}\n        </button>\n      </bit-menu>\n    </div>\n    <button\n      *ngIf=\"!organization.canCreateNewCollections\"\n      type=\"button\"\n      bitButton\n      buttonType=\"primary\"\n      (click)=\"addCipher()\"\n    >\n      <i class=\"bwi bwi-plus bwi-fw\" aria-hidden=\"true\"></i>\n      {{ \"newItem\" | i18n }}\n    </button>\n  </div>\n</div>\n","import { Component, EventEmitter, Input, Output } from \"@angular/core\";\nimport { Router } from \"@angular/router\";\nimport { firstValueFrom } from \"rxjs\";\n\nimport {\n  SimpleDialogType,\n  DialogServiceAbstraction,\n  SimpleDialogCloseType,\n  SimpleDialogOptions,\n} from \"@bitwarden/angular/services/dialog\";\nimport { I18nService } from \"@bitwarden/common/abstractions/i18n.service\";\nimport { OrganizationService } from \"@bitwarden/common/admin-console/abstractions/organization/organization.service.abstraction\";\nimport { Organization } from \"@bitwarden/common/admin-console/models/domain/organization\";\nimport { ProductType } from \"@bitwarden/common/enums\";\nimport { TreeNode } from \"@bitwarden/common/models/domain/tree-node\";\n\nimport {\n  CollectionAdminService,\n  CollectionAdminView,\n} from \"../../../admin-console/organizations/core\";\nimport { CollectionDialogTabType } from \"../../../admin-console/organizations/shared\";\nimport {\n  All,\n  RoutedVaultFilterModel,\n  Unassigned,\n} from \"../../individual-vault/vault-filter/shared/models/routed-vault-filter.model\";\n\n@Component({\n  selector: \"app-org-vault-header\",\n  templateUrl: \"./vault-header.component.html\",\n})\nexport class VaultHeaderComponent {\n  protected All = All;\n  protected Unassigned = Unassigned;\n\n  /**\n   * Boolean to determine the loading state of the header.\n   * Shows a loading spinner if set to true\n   */\n  @Input() loading: boolean;\n\n  /** Current active fitler */\n  @Input() filter: RoutedVaultFilterModel;\n\n  /** The organization currently being viewed */\n  @Input() organization: Organization;\n\n  /** Currently selected collection */\n  @Input() collection?: TreeNode<CollectionAdminView>;\n\n  /** Emits an event when the new item button is clicked in the header */\n  @Output() onAddCipher = new EventEmitter<void>();\n\n  /** Emits an event when the new collection button is clicked in the header */\n  @Output() onAddCollection = new EventEmitter<void>();\n\n  /** Emits an event when the edit collection button is clicked in the header */\n  @Output() onEditCollection = new EventEmitter<{ tab: CollectionDialogTabType }>();\n\n  /** Emits an event when the delete collection button is clicked in the header */\n  @Output() onDeleteCollection = new EventEmitter<void>();\n\n  protected CollectionDialogTabType = CollectionDialogTabType;\n  protected organizations$ = this.organizationService.organizations$;\n\n  constructor(\n    private organizationService: OrganizationService,\n    private i18nService: I18nService,\n    private dialogService: DialogServiceAbstraction,\n    private collectionAdminService: CollectionAdminService,\n    private router: Router\n  ) {}\n\n  get title() {\n    if (this.collection !== undefined) {\n      return this.collection.node.name;\n    }\n\n    if (this.filter.collectionId === Unassigned) {\n      return this.i18nService.t(\"unassigned\");\n    }\n\n    return `${this.organization.name} ${this.i18nService.t(\"vault\").toLowerCase()}`;\n  }\n\n  protected get showBreadcrumbs() {\n    return this.filter.collectionId !== undefined && this.filter.collectionId !== All;\n  }\n\n  /**\n   * A list of collection filters that form a chain from the organization root to currently selected collection.\n   * Begins from the organization root and excludes the currently selected collection.\n   */\n  protected get collections() {\n    if (this.collection == undefined) {\n      return [];\n    }\n\n    const collections = [this.collection];\n    while (collections[collections.length - 1].parent != undefined) {\n      collections.push(collections[collections.length - 1].parent);\n    }\n\n    return collections\n      .slice(1)\n      .reverse()\n      .map((treeNode) => treeNode.node);\n  }\n\n  private showFreeOrgUpgradeDialog(): void {\n    const orgUpgradeSimpleDialogOpts: SimpleDialogOptions = {\n      title: this.i18nService.t(\"upgradeOrganization\"),\n      content: this.i18nService.t(\n        this.organization.canEditSubscription\n          ? \"freeOrgMaxCollectionReachedManageBilling\"\n          : \"freeOrgMaxCollectionReachedNoManageBilling\",\n        this.organization.maxCollections\n      ),\n      type: SimpleDialogType.PRIMARY,\n    };\n\n    if (this.organization.canEditSubscription) {\n      orgUpgradeSimpleDialogOpts.acceptButtonText = this.i18nService.t(\"upgrade\");\n    } else {\n      orgUpgradeSimpleDialogOpts.acceptButtonText = this.i18nService.t(\"ok\");\n      orgUpgradeSimpleDialogOpts.cancelButtonText = null; // hide secondary btn\n    }\n\n    const simpleDialog = this.dialogService.openSimpleDialogRef(orgUpgradeSimpleDialogOpts);\n\n    firstValueFrom(simpleDialog.closed).then((result: SimpleDialogCloseType | undefined) => {\n      if (!result) {\n        return;\n      }\n\n      if (result == SimpleDialogCloseType.ACCEPT && this.organization.canEditSubscription) {\n        this.router.navigate([\"/organizations\", this.organization.id, \"billing\", \"subscription\"], {\n          queryParams: { upgrade: true },\n        });\n      }\n    });\n  }\n\n  get canEditCollection(): boolean {\n    // Only edit collections if not editing \"Unassigned\"\n    if (this.collection === undefined) {\n      return false;\n    }\n\n    // Otherwise, check if we can edit the specified collection\n    return (\n      this.organization.canEditAnyCollection ||\n      (this.organization.canEditAssignedCollections && this.collection?.node.assigned)\n    );\n  }\n\n  addCipher() {\n    this.onAddCipher.emit();\n  }\n\n  async addCollection() {\n    if (this.organization.planProductType === ProductType.Free) {\n      const collections = await this.collectionAdminService.getAll(this.organization.id);\n      if (collections.length === this.organization.maxCollections) {\n        this.showFreeOrgUpgradeDialog();\n        return;\n      }\n    }\n\n    this.onAddCollection.emit();\n  }\n\n  async editCollection(tab: CollectionDialogTabType): Promise<void> {\n    this.onEditCollection.emit({ tab });\n  }\n\n  get canDeleteCollection(): boolean {\n    // Only delete collections if not deleting \"Unassigned\"\n    if (this.collection === undefined) {\n      return false;\n    }\n\n    // Otherwise, check if we can delete the specified collection\n    return (\n      this.organization?.canDeleteAnyCollection ||\n      (this.organization?.canDeleteAssignedCollections && this.collection.node.assigned)\n    );\n  }\n\n  deleteCollection() {\n    this.onDeleteCollection.emit();\n  }\n}\n","<div class=\"container page-content\">\n  <div class=\"row\">\n    <div class=\"col-3\">\n      <div class=\"groupings\">\n        <div class=\"content\">\n          <div class=\"inner-content\">\n            <app-organization-vault-filter\n              #vaultFilter\n              [organization]=\"organization\"\n              [activeFilter]=\"activeFilter\"\n              [searchText]=\"currentSearchText$ | async\"\n              (searchTextChanged)=\"filterSearchText($event)\"\n            ></app-organization-vault-filter>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"col-9\">\n      <app-org-vault-header\n        [filter]=\"filter\"\n        [loading]=\"refreshing\"\n        [organization]=\"organization\"\n        [collection]=\"selectedCollection\"\n        (onAddCipher)=\"addCipher()\"\n        (onAddCollection)=\"addCollection()\"\n        (onEditCollection)=\"editCollection(selectedCollection.node, $event.tab)\"\n        (onDeleteCollection)=\"deleteCollection(selectedCollection.node)\"\n      ></app-org-vault-header>\n      <app-callout\n        type=\"warning\"\n        *ngIf=\"activeFilter.isDeleted\"\n        icon=\"bwi bwi-exclamation-triangle\"\n      >\n        {{ trashCleanupWarning }}\n      </app-callout>\n      <app-vault-items\n        [ciphers]=\"ciphers\"\n        [collections]=\"collections\"\n        [allCollections]=\"allCollections\"\n        [allOrganizations]=\"organization ? [organization] : []\"\n        [allGroups]=\"allGroups\"\n        [disabled]=\"loading\"\n        [showOwner]=\"false\"\n        [showCollections]=\"filter.type !== undefined\"\n        [showGroups]=\"\n          organization?.useGroups &&\n          ((filter.type === undefined && filter.collectionId === undefined) ||\n            filter.collectionId !== undefined)\n        \"\n        [showPremiumFeatures]=\"organization?.useTotp\"\n        [showBulkMove]=\"false\"\n        [showBulkTrashOptions]=\"filter.type === 'trash'\"\n        [useEvents]=\"organization?.useEvents\"\n        [editableCollections]=\"true\"\n        [cloneableOrganizationCiphers]=\"true\"\n        (onEvent)=\"onVaultItemsEvent($event)\"\n      >\n      </app-vault-items>\n      <div\n        class=\"tw-mt-6 tw-flex tw-h-full tw-flex-col tw-items-center tw-justify-start\"\n        *ngIf=\"showMissingCollectionPermissionMessage\"\n      >\n        <bit-icon [icon]=\"noItemIcon\" aria-hidden=\"true\"></bit-icon>\n        <p>{{ \"noPermissionToViewAllCollectionItems\" | i18n }}</p>\n      </div>\n      <div\n        class=\"tw-mt-6 tw-flex tw-h-full tw-flex-col tw-items-center tw-justify-start\"\n        *ngIf=\"isEmpty && !showMissingCollectionPermissionMessage && !performingInitialLoad\"\n      >\n        <bit-icon [icon]=\"noItemIcon\" aria-hidden=\"true\"></bit-icon>\n        <p>{{ \"noItemsInList\" | i18n }}</p>\n        <button\n          type=\"button\"\n          buttonType=\"primary\"\n          bitButton\n          (click)=\"addCipher()\"\n          *ngIf=\"filter.type !== 'trash' && filter.collectionId !== Unassigned\"\n        >\n          <i class=\"bwi bwi-plus bwi-fw\" aria-hidden=\"true\"></i>\n          {{ \"newItem\" | i18n }}\n        </button>\n      </div>\n      <div\n        class=\"tw-mt-6 tw-flex tw-h-full tw-flex-col tw-items-center tw-justify-start\"\n        *ngIf=\"performingInitialLoad\"\n      >\n        <i\n          class=\"bwi bwi-spinner bwi-spin text-muted\"\n          title=\"{{ 'loading' | i18n }}\"\n          aria-hidden=\"true\"\n        ></i>\n        <span class=\"sr-only\">{{ \"loading\" | i18n }}</span>\n      </div>\n    </div>\n  </div>\n  <ng-template #attachments></ng-template>\n  <ng-template #cipherAddEdit></ng-template>\n  <ng-template #collectionsModal></ng-template>\n  <ng-template #eventsTemplate></ng-template>\n</div>\n","import {\n  ChangeDetectorRef,\n  Component,\n  NgZone,\n  OnDestroy,\n  OnInit,\n  ViewChild,\n  ViewContainerRef,\n} from \"@angular/core\";\nimport { ActivatedRoute, Params, Router } from \"@angular/router\";\nimport {\n  BehaviorSubject,\n  combineLatest,\n  firstValueFrom,\n  lastValueFrom,\n  Observable,\n  Subject,\n} from \"rxjs\";\nimport {\n  concatMap,\n  debounceTime,\n  distinctUntilChanged,\n  filter,\n  first,\n  map,\n  shareReplay,\n  switchMap,\n  takeUntil,\n  tap,\n} from \"rxjs/operators\";\n\nimport { SearchPipe } from \"@bitwarden/angular/pipes/search.pipe\";\nimport { DialogServiceAbstraction, SimpleDialogType } from \"@bitwarden/angular/services/dialog\";\nimport { ModalService } from \"@bitwarden/angular/services/modal.service\";\nimport { ApiService } from \"@bitwarden/common/abstractions/api.service\";\nimport { BroadcasterService } from \"@bitwarden/common/abstractions/broadcaster.service\";\nimport { EventCollectionService } from \"@bitwarden/common/abstractions/event/event-collection.service\";\nimport { I18nService } from \"@bitwarden/common/abstractions/i18n.service\";\nimport { LogService } from \"@bitwarden/common/abstractions/log.service\";\nimport { MessagingService } from \"@bitwarden/common/abstractions/messaging.service\";\nimport { PlatformUtilsService } from \"@bitwarden/common/abstractions/platformUtils.service\";\nimport { SearchService } from \"@bitwarden/common/abstractions/search.service\";\nimport { TotpService } from \"@bitwarden/common/abstractions/totp.service\";\nimport { OrganizationService } from \"@bitwarden/common/admin-console/abstractions/organization/organization.service.abstraction\";\nimport { Organization } from \"@bitwarden/common/admin-console/models/domain/organization\";\nimport { CollectionView } from \"@bitwarden/common/admin-console/models/view/collection.view\";\nimport { EventType } from \"@bitwarden/common/enums\";\nimport { ServiceUtils } from \"@bitwarden/common/misc/serviceUtils\";\nimport { Utils } from \"@bitwarden/common/misc/utils\";\nimport { TreeNode } from \"@bitwarden/common/models/domain/tree-node\";\nimport { CipherService } from \"@bitwarden/common/vault/abstractions/cipher.service\";\nimport { PasswordRepromptService } from \"@bitwarden/common/vault/abstractions/password-reprompt.service\";\nimport { SyncService } from \"@bitwarden/common/vault/abstractions/sync/sync.service.abstraction\";\nimport { CipherRepromptType } from \"@bitwarden/common/vault/enums/cipher-reprompt-type\";\nimport { CipherView } from \"@bitwarden/common/vault/models/view/cipher.view\";\nimport { Icons } from \"@bitwarden/components\";\n\nimport {\n  CollectionAdminService,\n  CollectionAdminView,\n  GroupService,\n  GroupView,\n} from \"../../admin-console/organizations/core\";\nimport { EntityEventsComponent } from \"../../admin-console/organizations/manage/entity-events.component\";\nimport {\n  CollectionDialogResult,\n  CollectionDialogTabType,\n  openCollectionDialog,\n} from \"../../admin-console/organizations/shared\";\nimport { VaultFilterService } from \"../../vault/individual-vault/vault-filter/services/abstractions/vault-filter.service\";\nimport { VaultFilter } from \"../../vault/individual-vault/vault-filter/shared/models/vault-filter.model\";\nimport { VaultItemEvent } from \"../components/vault-items/vault-item-event\";\nimport {\n  BulkDeleteDialogResult,\n  openBulkDeleteDialog,\n} from \"../individual-vault/bulk-action-dialogs/bulk-delete-dialog/bulk-delete-dialog.component\";\nimport {\n  BulkRestoreDialogResult,\n  openBulkRestoreDialog,\n} from \"../individual-vault/bulk-action-dialogs/bulk-restore-dialog/bulk-restore-dialog.component\";\nimport { RoutedVaultFilterBridgeService } from \"../individual-vault/vault-filter/services/routed-vault-filter-bridge.service\";\nimport { RoutedVaultFilterService } from \"../individual-vault/vault-filter/services/routed-vault-filter.service\";\nimport { createFilterFunction } from \"../individual-vault/vault-filter/shared/models/filter-function\";\nimport {\n  All,\n  RoutedVaultFilterModel,\n  Unassigned,\n} from \"../individual-vault/vault-filter/shared/models/routed-vault-filter.model\";\nimport { getNestedCollectionTree } from \"../utils/collection-utils\";\n\nimport { AddEditComponent } from \"./add-edit.component\";\nimport { AttachmentsComponent } from \"./attachments.component\";\nimport { CollectionsComponent } from \"./collections.component\";\nimport { VaultFilterComponent } from \"./vault-filter/vault-filter.component\";\n\nconst BroadcasterSubscriptionId = \"OrgVaultComponent\";\nconst SearchTextDebounceInterval = 200;\n\n@Component({\n  selector: \"app-org-vault\",\n  templateUrl: \"vault.component.html\",\n  providers: [RoutedVaultFilterService, RoutedVaultFilterBridgeService],\n})\nexport class VaultComponent implements OnInit, OnDestroy {\n  protected Unassigned = Unassigned;\n\n  @ViewChild(\"vaultFilter\", { static: true })\n  vaultFilterComponent: VaultFilterComponent;\n  @ViewChild(\"attachments\", { read: ViewContainerRef, static: true })\n  attachmentsModalRef: ViewContainerRef;\n  @ViewChild(\"cipherAddEdit\", { read: ViewContainerRef, static: true })\n  cipherAddEditModalRef: ViewContainerRef;\n  @ViewChild(\"collectionsModal\", { read: ViewContainerRef, static: true })\n  collectionsModalRef: ViewContainerRef;\n  @ViewChild(\"eventsTemplate\", { read: ViewContainerRef, static: true })\n  eventsModalRef: ViewContainerRef;\n\n  trashCleanupWarning: string = null;\n  activeFilter: VaultFilter = new VaultFilter();\n\n  protected noItemIcon = Icons.Search;\n  protected performingInitialLoad = true;\n  protected refreshing = false;\n  protected processingEvent = false;\n  protected filter: RoutedVaultFilterModel = {};\n  protected organization: Organization;\n  protected allCollections: CollectionAdminView[];\n  protected allGroups: GroupView[];\n  protected ciphers: CipherView[];\n  protected collections: CollectionAdminView[];\n  protected selectedCollection: TreeNode<CollectionAdminView> | undefined;\n  protected isEmpty: boolean;\n  protected showMissingCollectionPermissionMessage: boolean;\n  protected currentSearchText$: Observable<string>;\n\n  private searchText$ = new Subject<string>();\n  private refresh$ = new BehaviorSubject<void>(null);\n  private destroy$ = new Subject<void>();\n\n  constructor(\n    private route: ActivatedRoute,\n    private organizationService: OrganizationService,\n    protected vaultFilterService: VaultFilterService,\n    private routedVaultFilterBridgeService: RoutedVaultFilterBridgeService,\n    private routedVaultFilterService: RoutedVaultFilterService,\n    private router: Router,\n    private changeDetectorRef: ChangeDetectorRef,\n    private syncService: SyncService,\n    private i18nService: I18nService,\n    private modalService: ModalService,\n    private dialogService: DialogServiceAbstraction,\n    private messagingService: MessagingService,\n    private broadcasterService: BroadcasterService,\n    private ngZone: NgZone,\n    private platformUtilsService: PlatformUtilsService,\n    private cipherService: CipherService,\n    private passwordRepromptService: PasswordRepromptService,\n    private collectionAdminService: CollectionAdminService,\n    private searchService: SearchService,\n    private searchPipe: SearchPipe,\n    private groupService: GroupService,\n    private logService: LogService,\n    private eventCollectionService: EventCollectionService,\n    private totpService: TotpService,\n    private apiService: ApiService\n  ) {}\n\n  async ngOnInit() {\n    this.trashCleanupWarning = this.i18nService.t(\n      this.platformUtilsService.isSelfHost()\n        ? \"trashCleanupWarningSelfHosted\"\n        : \"trashCleanupWarning\"\n    );\n\n    const filter$ = this.routedVaultFilterService.filter$;\n    const organizationId$ = filter$.pipe(\n      map((filter) => filter.organizationId),\n      filter((filter) => filter !== undefined),\n      distinctUntilChanged()\n    );\n\n    const organization$ = organizationId$.pipe(\n      switchMap((organizationId) => this.organizationService.get$(organizationId)),\n      takeUntil(this.destroy$),\n      shareReplay({ refCount: false, bufferSize: 1 })\n    );\n\n    const firstSetup$ = combineLatest([organization$, this.route.queryParams]).pipe(\n      first(),\n      switchMap(async ([organization]) => {\n        this.organization = organization;\n\n        if (!organization.canUseAdminCollections) {\n          await this.syncService.fullSync(false);\n        }\n\n        return undefined;\n      }),\n      shareReplay({ refCount: true, bufferSize: 1 })\n    );\n\n    this.broadcasterService.subscribe(BroadcasterSubscriptionId, (message: any) => {\n      this.ngZone.run(async () => {\n        switch (message.command) {\n          case \"syncCompleted\":\n            if (message.successfully) {\n              this.refresh();\n              this.changeDetectorRef.detectChanges();\n            }\n            break;\n        }\n      });\n    });\n\n    this.routedVaultFilterBridgeService.activeFilter$\n      .pipe(takeUntil(this.destroy$))\n      .subscribe((activeFilter) => {\n        this.activeFilter = activeFilter;\n      });\n\n    this.searchText$\n      .pipe(debounceTime(SearchTextDebounceInterval), takeUntil(this.destroy$))\n      .subscribe((searchText) =>\n        this.router.navigate([], {\n          queryParams: { search: Utils.isNullOrEmpty(searchText) ? null : searchText },\n          queryParamsHandling: \"merge\",\n          replaceUrl: true,\n        })\n      );\n\n    this.currentSearchText$ = this.route.queryParams.pipe(map((queryParams) => queryParams.search));\n\n    const allCollectionsWithoutUnassigned$ = organizationId$.pipe(\n      switchMap((orgId) => this.collectionAdminService.getAll(orgId)),\n      shareReplay({ refCount: true, bufferSize: 1 })\n    );\n\n    const allCollections$ = combineLatest([organizationId$, allCollectionsWithoutUnassigned$]).pipe(\n      map(([organizationId, allCollections]) => {\n        const noneCollection = new CollectionAdminView();\n        noneCollection.name = this.i18nService.t(\"unassigned\");\n        noneCollection.id = Unassigned;\n        noneCollection.organizationId = organizationId;\n        return allCollections.concat(noneCollection);\n      })\n    );\n\n    const allGroups$ = organizationId$.pipe(\n      switchMap((organizationId) => this.groupService.getAll(organizationId)),\n      shareReplay({ refCount: true, bufferSize: 1 })\n    );\n\n    const allCiphers$ = organization$.pipe(\n      concatMap(async (organization) => {\n        let ciphers;\n        if (organization.canEditAnyCollection) {\n          ciphers = await this.cipherService.getAllFromApiForOrganization(organization.id);\n        } else {\n          ciphers = (await this.cipherService.getAllDecrypted()).filter(\n            (c) => c.organizationId === organization.id\n          );\n        }\n        await this.searchService.indexCiphers(ciphers, organization.id);\n        return ciphers;\n      })\n    );\n\n    const ciphers$ = combineLatest([allCiphers$, filter$, this.currentSearchText$]).pipe(\n      filter(([ciphers, filter]) => ciphers != undefined && filter != undefined),\n      concatMap(async ([ciphers, filter, searchText]) => {\n        if (filter.collectionId === undefined && filter.type === undefined) {\n          return [];\n        }\n\n        const filterFunction = createFilterFunction(filter);\n\n        if (this.searchService.isSearchable(searchText)) {\n          return await this.searchService.searchCiphers(searchText, [filterFunction], ciphers);\n        }\n\n        return ciphers.filter(filterFunction);\n      }),\n      shareReplay({ refCount: true, bufferSize: 1 })\n    );\n\n    const nestedCollections$ = allCollections$.pipe(\n      map((collections) => getNestedCollectionTree(collections)),\n      shareReplay({ refCount: true, bufferSize: 1 })\n    );\n\n    const collections$ = combineLatest([nestedCollections$, filter$, this.currentSearchText$]).pipe(\n      filter(([collections, filter]) => collections != undefined && filter != undefined),\n      map(([collections, filter, searchText]) => {\n        if (\n          filter.collectionId === Unassigned ||\n          (filter.collectionId === undefined && filter.type !== undefined)\n        ) {\n          return [];\n        }\n\n        let collectionsToReturn = [];\n        if (filter.collectionId === undefined || filter.collectionId === All) {\n          collectionsToReturn = collections.map((c) => c.node);\n        } else {\n          const selectedCollection = ServiceUtils.getTreeNodeObjectFromList(\n            collections,\n            filter.collectionId\n          );\n          collectionsToReturn = selectedCollection?.children.map((c) => c.node) ?? [];\n        }\n\n        if (this.searchService.isSearchable(searchText)) {\n          collectionsToReturn = this.searchPipe.transform(\n            collectionsToReturn,\n            searchText,\n            (collection) => collection.name,\n            (collection) => collection.id\n          );\n        }\n\n        return collectionsToReturn;\n      }),\n      takeUntil(this.destroy$),\n      shareReplay({ refCount: true, bufferSize: 1 })\n    );\n\n    const selectedCollection$ = combineLatest([nestedCollections$, filter$]).pipe(\n      filter(([collections, filter]) => collections != undefined && filter != undefined),\n      map(([collections, filter]) => {\n        if (\n          filter.collectionId === undefined ||\n          filter.collectionId === All ||\n          filter.collectionId === Unassigned\n        ) {\n          return undefined;\n        }\n\n        return ServiceUtils.getTreeNodeObjectFromList(collections, filter.collectionId);\n      }),\n      shareReplay({ refCount: true, bufferSize: 1 })\n    );\n\n    const showMissingCollectionPermissionMessage$ = combineLatest([\n      filter$,\n      selectedCollection$,\n      organization$,\n    ]).pipe(\n      map(([filter, collection, organization]) => {\n        return (\n          // Filtering by unassigned, show message if not admin\n          (filter.collectionId === Unassigned && !organization.canUseAdminCollections) ||\n          // Filtering by a collection, so show message if user is not assigned\n          (collection != undefined &&\n            !collection.node.assigned &&\n            !organization.canUseAdminCollections)\n        );\n      }),\n      shareReplay({ refCount: true, bufferSize: 1 })\n    );\n\n    firstSetup$\n      .pipe(\n        switchMap(() => combineLatest([this.route.queryParams, organization$])),\n        switchMap(async ([qParams, organization]) => {\n          const cipherId = getCipherIdFromParams(qParams);\n          if (!cipherId) {\n            return;\n          }\n          if (\n            // Handle users with implicit collection access since they use the admin endpoint\n            organization.canUseAdminCollections ||\n            (await this.cipherService.get(cipherId)) != null\n          ) {\n            this.editCipherId(cipherId);\n          } else {\n            this.platformUtilsService.showToast(\n              \"error\",\n              this.i18nService.t(\"errorOccurred\"),\n              this.i18nService.t(\"unknownCipher\")\n            );\n            this.router.navigate([], {\n              queryParams: { cipherId: null, itemId: null },\n              queryParamsHandling: \"merge\",\n            });\n          }\n        }),\n        takeUntil(this.destroy$)\n      )\n      .subscribe();\n\n    firstSetup$\n      .pipe(\n        switchMap(() => combineLatest([this.route.queryParams, organization$, allCiphers$])),\n        switchMap(async ([qParams, organization, allCiphers$]) => {\n          const cipherId = qParams.viewEvents;\n          if (!cipherId) {\n            return;\n          }\n          const cipher = allCiphers$.find((c) => c.id === cipherId);\n          if (organization.useEvents && cipher != undefined) {\n            this.viewEvents(cipher);\n          } else {\n            this.platformUtilsService.showToast(\n              \"error\",\n              this.i18nService.t(\"errorOccurred\"),\n              this.i18nService.t(\"unknownCipher\")\n            );\n            this.router.navigate([], {\n              queryParams: { viewEvents: null },\n              queryParamsHandling: \"merge\",\n            });\n          }\n        }),\n        takeUntil(this.destroy$)\n      )\n      .subscribe();\n\n    firstSetup$\n      .pipe(\n        switchMap(() => this.refresh$),\n        tap(() => (this.refreshing = true)),\n        switchMap(() =>\n          combineLatest([\n            organization$,\n            filter$,\n            allCollections$,\n            allGroups$,\n            ciphers$,\n            collections$,\n            selectedCollection$,\n            showMissingCollectionPermissionMessage$,\n          ])\n        ),\n        takeUntil(this.destroy$)\n      )\n      .subscribe(\n        ([\n          organization,\n          filter,\n          allCollections,\n          allGroups,\n          ciphers,\n          collections,\n          selectedCollection,\n          showMissingCollectionPermissionMessage,\n        ]) => {\n          this.organization = organization;\n          this.filter = filter;\n          this.allCollections = allCollections;\n          this.allGroups = allGroups;\n          this.ciphers = ciphers;\n          this.collections = collections;\n          this.selectedCollection = selectedCollection;\n          this.showMissingCollectionPermissionMessage = showMissingCollectionPermissionMessage;\n\n          this.isEmpty = collections?.length === 0 && ciphers?.length === 0;\n\n          // This is a temporary fix to avoid double fetching collections.\n          // TODO: Remove when implementing new VVR menu\n          this.vaultFilterService.reloadCollections(allCollections);\n\n          this.refreshing = false;\n          this.performingInitialLoad = false;\n        }\n      );\n  }\n\n  get loading() {\n    return this.refreshing || this.processingEvent;\n  }\n\n  ngOnDestroy() {\n    this.broadcasterService.unsubscribe(BroadcasterSubscriptionId);\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n\n  async onVaultItemsEvent(event: VaultItemEvent) {\n    this.processingEvent = true;\n\n    try {\n      if (event.type === \"viewAttachments\") {\n        await this.editCipherAttachments(event.item);\n      } else if (event.type === \"viewCollections\") {\n        await this.editCipherCollections(event.item);\n      } else if (event.type === \"clone\") {\n        await this.cloneCipher(event.item);\n      } else if (event.type === \"restore\") {\n        if (event.items.length === 1) {\n          await this.restore(event.items[0]);\n        } else {\n          await this.bulkRestore(event.items);\n        }\n      } else if (event.type === \"delete\") {\n        const ciphers = event.items.filter((i) => i.collection === undefined).map((i) => i.cipher);\n        const collections = event.items\n          .filter((i) => i.cipher === undefined)\n          .map((i) => i.collection);\n        if (ciphers.length === 1 && collections.length === 0) {\n          await this.deleteCipher(ciphers[0]);\n        } else if (ciphers.length === 0 && collections.length === 1) {\n          await this.deleteCollection(collections[0]);\n        } else {\n          await this.bulkDelete(ciphers, collections, this.organization);\n        }\n      } else if (event.type === \"copyField\") {\n        await this.copy(event.item, event.field);\n      } else if (event.type === \"edit\") {\n        await this.editCollection(event.item, CollectionDialogTabType.Info);\n      } else if (event.type === \"viewAccess\") {\n        await this.editCollection(event.item, CollectionDialogTabType.Access);\n      } else if (event.type === \"viewEvents\") {\n        await this.viewEvents(event.item);\n      }\n    } finally {\n      this.processingEvent = false;\n    }\n  }\n\n  filterSearchText(searchText: string) {\n    this.searchText$.next(searchText);\n  }\n\n  async editCipherAttachments(cipher: CipherView) {\n    if (this.organization.maxStorageGb == null || this.organization.maxStorageGb === 0) {\n      this.messagingService.send(\"upgradeOrganization\", { organizationId: cipher.organizationId });\n      return;\n    }\n\n    let madeAttachmentChanges = false;\n\n    const [modal] = await this.modalService.openViewRef(\n      AttachmentsComponent,\n      this.attachmentsModalRef,\n      (comp) => {\n        comp.organization = this.organization;\n        comp.cipherId = cipher.id;\n        comp.onUploadedAttachment\n          .pipe(takeUntil(this.destroy$))\n          .subscribe(() => (madeAttachmentChanges = true));\n        comp.onDeletedAttachment\n          .pipe(takeUntil(this.destroy$))\n          .subscribe(() => (madeAttachmentChanges = true));\n      }\n    );\n\n    modal.onClosed.pipe(takeUntil(this.destroy$)).subscribe(() => {\n      if (madeAttachmentChanges) {\n        this.refresh();\n      }\n      madeAttachmentChanges = false;\n    });\n  }\n\n  async editCipherCollections(cipher: CipherView) {\n    const currCollections = await firstValueFrom(this.vaultFilterService.filteredCollections$);\n    const [modal] = await this.modalService.openViewRef(\n      CollectionsComponent,\n      this.collectionsModalRef,\n      (comp) => {\n        comp.collectionIds = cipher.collectionIds;\n        comp.collections = currCollections.filter((c) => !c.readOnly && c.id != Unassigned);\n        comp.organization = this.organization;\n        comp.cipherId = cipher.id;\n        comp.onSavedCollections.pipe(takeUntil(this.destroy$)).subscribe(() => {\n          modal.close();\n          this.refresh();\n        });\n      }\n    );\n  }\n\n  async addCipher() {\n    const collections = (await firstValueFrom(this.vaultFilterService.filteredCollections$)).filter(\n      (c) => !c.readOnly && c.id != Unassigned\n    );\n\n    await this.editCipher(null, (comp) => {\n      comp.type = this.activeFilter.cipherType;\n      comp.collections = collections;\n      if (this.activeFilter.collectionId) {\n        comp.collectionIds = [this.activeFilter.collectionId];\n      }\n    });\n  }\n\n  async navigateToCipher(cipher: CipherView) {\n    this.go({ itemId: cipher?.id });\n  }\n\n  async editCipher(\n    cipher: CipherView,\n    additionalComponentParameters?: (comp: AddEditComponent) => void\n  ) {\n    return this.editCipherId(cipher?.id, additionalComponentParameters);\n  }\n\n  async editCipherId(\n    cipherId: string,\n    additionalComponentParameters?: (comp: AddEditComponent) => void\n  ) {\n    const cipher = await this.cipherService.get(cipherId);\n    if (cipher != null && cipher.reprompt != 0) {\n      if (!(await this.passwordRepromptService.showPasswordPrompt())) {\n        this.go({ cipherId: null, itemId: null });\n        return;\n      }\n    }\n\n    const defaultComponentParameters = (comp: AddEditComponent) => {\n      comp.organization = this.organization;\n      comp.organizationId = this.organization.id;\n      comp.cipherId = cipherId;\n      comp.onSavedCipher.pipe(takeUntil(this.destroy$)).subscribe(() => {\n        modal.close();\n        this.refresh();\n      });\n      comp.onDeletedCipher.pipe(takeUntil(this.destroy$)).subscribe(() => {\n        modal.close();\n        this.refresh();\n      });\n      comp.onRestoredCipher.pipe(takeUntil(this.destroy$)).subscribe(() => {\n        modal.close();\n        this.refresh();\n      });\n    };\n\n    const [modal, childComponent] = await this.modalService.openViewRef(\n      AddEditComponent,\n      this.cipherAddEditModalRef,\n      additionalComponentParameters == null\n        ? defaultComponentParameters\n        : (comp) => {\n            defaultComponentParameters(comp);\n            additionalComponentParameters(comp);\n          }\n    );\n\n    modal.onClosedPromise().then(() => {\n      this.go({ cipherId: null, itemId: null });\n    });\n\n    return childComponent;\n  }\n\n  async cloneCipher(cipher: CipherView) {\n    const collections = (await firstValueFrom(this.vaultFilterService.filteredCollections$)).filter(\n      (c) => !c.readOnly && c.id != Unassigned\n    );\n\n    await this.editCipher(cipher, (comp) => {\n      comp.cloneMode = true;\n      comp.collections = collections;\n      comp.collectionIds = cipher.collectionIds;\n    });\n  }\n\n  async restore(c: CipherView): Promise<boolean> {\n    if (!(await this.repromptCipher([c]))) {\n      return;\n    }\n\n    if (!c.isDeleted) {\n      return;\n    }\n\n    const confirmed = await this.dialogService.openSimpleDialog({\n      title: { key: \"restoreItem\" },\n      content: { key: \"restoreItemConfirmation\" },\n      type: SimpleDialogType.WARNING,\n    });\n\n    if (!confirmed) {\n      return false;\n    }\n\n    try {\n      const asAdmin = this.organization?.canEditAnyCollection;\n      await this.cipherService.restoreWithServer(c.id, asAdmin);\n      this.platformUtilsService.showToast(\"success\", null, this.i18nService.t(\"restoredItem\"));\n      this.refresh();\n    } catch (e) {\n      this.logService.error(e);\n    }\n  }\n\n  async bulkRestore(ciphers: CipherView[]) {\n    if (!(await this.repromptCipher(ciphers))) {\n      return;\n    }\n\n    const selectedCipherIds = ciphers.map((cipher) => cipher.id);\n    if (selectedCipherIds.length === 0) {\n      this.platformUtilsService.showToast(\n        \"error\",\n        this.i18nService.t(\"errorOccurred\"),\n        this.i18nService.t(\"nothingSelected\")\n      );\n      return;\n    }\n\n    const dialog = openBulkRestoreDialog(this.dialogService, {\n      data: { cipherIds: selectedCipherIds },\n    });\n\n    const result = await lastValueFrom(dialog.closed);\n    if (result === BulkRestoreDialogResult.Restored) {\n      this.refresh();\n    }\n  }\n\n  async deleteCipher(c: CipherView): Promise<boolean> {\n    if (!(await this.repromptCipher([c]))) {\n      return;\n    }\n\n    const permanent = c.isDeleted;\n\n    const confirmed = await this.dialogService.openSimpleDialog({\n      title: { key: permanent ? \"permanentlyDeleteItem\" : \"deleteItem\" },\n      content: { key: permanent ? \"permanentlyDeleteItemConfirmation\" : \"deleteItemConfirmation\" },\n      type: SimpleDialogType.WARNING,\n    });\n\n    if (!confirmed) {\n      return false;\n    }\n\n    try {\n      await this.deleteCipherWithServer(c.id, permanent);\n      this.platformUtilsService.showToast(\n        \"success\",\n        null,\n        this.i18nService.t(permanent ? \"permanentlyDeletedItem\" : \"deletedItem\")\n      );\n      this.refresh();\n    } catch (e) {\n      this.logService.error(e);\n    }\n  }\n\n  async deleteCollection(collection: CollectionView): Promise<void> {\n    if (\n      !this.organization.canDeleteAssignedCollections &&\n      !this.organization.canDeleteAnyCollection\n    ) {\n      this.platformUtilsService.showToast(\n        \"error\",\n        this.i18nService.t(\"errorOccurred\"),\n        this.i18nService.t(\"missingPermissions\")\n      );\n      return;\n    }\n    const confirmed = await this.dialogService.openSimpleDialog({\n      title: collection.name,\n      content: { key: \"deleteCollectionConfirmation\" },\n      type: SimpleDialogType.WARNING,\n    });\n\n    if (!confirmed) {\n      return;\n    }\n    try {\n      await this.apiService.deleteCollection(this.organization?.id, collection.id);\n      this.platformUtilsService.showToast(\n        \"success\",\n        null,\n        this.i18nService.t(\"deletedCollectionId\", collection.name)\n      );\n\n      // Navigate away if we deleted the colletion we were viewing\n      if (this.selectedCollection?.node.id === collection.id) {\n        this.router.navigate([], {\n          queryParams: { collectionId: this.selectedCollection.parent?.node.id ?? null },\n          queryParamsHandling: \"merge\",\n          replaceUrl: true,\n        });\n      }\n\n      this.refresh();\n    } catch (e) {\n      this.logService.error(e);\n    }\n  }\n\n  async bulkDelete(\n    ciphers: CipherView[],\n    collections: CollectionView[],\n    organization: Organization\n  ) {\n    if (!(await this.repromptCipher(ciphers))) {\n      return;\n    }\n\n    if (ciphers.length === 0 && collections.length === 0) {\n      this.platformUtilsService.showToast(\n        \"error\",\n        this.i18nService.t(\"errorOccurred\"),\n        this.i18nService.t(\"nothingSelected\")\n      );\n      return;\n    }\n    const dialog = openBulkDeleteDialog(this.dialogService, {\n      data: {\n        permanent: this.filter.type === \"trash\",\n        cipherIds: ciphers.map((c) => c.id),\n        collectionIds: collections.map((c) => c.id),\n        organization,\n      },\n    });\n\n    const result = await lastValueFrom(dialog.closed);\n    if (result === BulkDeleteDialogResult.Deleted) {\n      this.refresh();\n    }\n  }\n\n  async copy(cipher: CipherView, field: \"username\" | \"password\" | \"totp\") {\n    let aType;\n    let value;\n    let typeI18nKey;\n\n    if (field === \"username\") {\n      aType = \"Username\";\n      value = cipher.login.username;\n      typeI18nKey = \"username\";\n    } else if (field === \"password\") {\n      aType = \"Password\";\n      value = cipher.login.password;\n      typeI18nKey = \"password\";\n    } else if (field === \"totp\") {\n      aType = \"TOTP\";\n      value = await this.totpService.getCode(cipher.login.totp);\n      typeI18nKey = \"verificationCodeTotp\";\n    } else {\n      this.platformUtilsService.showToast(\"info\", null, this.i18nService.t(\"unexpectedError\"));\n      return;\n    }\n\n    if (\n      this.passwordRepromptService.protectedFields().includes(aType) &&\n      !(await this.repromptCipher([cipher]))\n    ) {\n      return;\n    }\n\n    if (!cipher.viewPassword) {\n      return;\n    }\n\n    this.platformUtilsService.copyToClipboard(value, { window: window });\n    this.platformUtilsService.showToast(\n      \"info\",\n      null,\n      this.i18nService.t(\"valueCopied\", this.i18nService.t(typeI18nKey))\n    );\n\n    if (field === \"password\") {\n      this.eventCollectionService.collect(EventType.Cipher_ClientCopiedPassword, cipher.id);\n    } else if (field === \"totp\") {\n      this.eventCollectionService.collect(EventType.Cipher_ClientCopiedHiddenField, cipher.id);\n    }\n  }\n\n  async addCollection(): Promise<void> {\n    const dialog = openCollectionDialog(this.dialogService, {\n      data: {\n        organizationId: this.organization?.id,\n        parentCollectionId: this.selectedCollection?.node.id,\n      },\n    });\n\n    const result = await lastValueFrom(dialog.closed);\n    if (result === CollectionDialogResult.Saved || result === CollectionDialogResult.Deleted) {\n      this.refresh();\n    }\n  }\n\n  async editCollection(c: CollectionView, tab: CollectionDialogTabType): Promise<void> {\n    const dialog = openCollectionDialog(this.dialogService, {\n      data: { collectionId: c?.id, organizationId: this.organization?.id, initialTab: tab },\n    });\n\n    const result = await lastValueFrom(dialog.closed);\n    if (result === CollectionDialogResult.Saved || result === CollectionDialogResult.Deleted) {\n      this.refresh();\n    }\n  }\n\n  async viewEvents(cipher: CipherView) {\n    await this.modalService.openViewRef(EntityEventsComponent, this.eventsModalRef, (comp) => {\n      comp.name = cipher.name;\n      comp.organizationId = this.organization.id;\n      comp.entityId = cipher.id;\n      comp.showUser = true;\n      comp.entity = \"cipher\";\n    });\n  }\n\n  protected deleteCipherWithServer(id: string, permanent: boolean) {\n    const asAdmin = this.organization?.canEditAnyCollection;\n    return permanent\n      ? this.cipherService.deleteWithServer(id, asAdmin)\n      : this.cipherService.softDeleteWithServer(id, asAdmin);\n  }\n\n  protected async repromptCipher(ciphers: CipherView[]) {\n    const notProtected = !ciphers.find((cipher) => cipher.reprompt !== CipherRepromptType.None);\n\n    return notProtected || (await this.passwordRepromptService.showPasswordPrompt());\n  }\n\n  private refresh() {\n    this.refresh$.next();\n  }\n\n  private go(queryParams: any = null) {\n    if (queryParams == null) {\n      queryParams = {\n        type: this.activeFilter.cipherType,\n        collectionId: this.activeFilter.collectionId,\n        deleted: this.activeFilter.isDeleted || null,\n      };\n    }\n\n    this.router.navigate([], {\n      relativeTo: this.route,\n      queryParams: queryParams,\n      queryParamsHandling: \"merge\",\n      replaceUrl: true,\n    });\n  }\n}\n\n/**\n * Allows backwards compatibility with\n * old links that used the original `cipherId` param\n */\nconst getCipherIdFromParams = (params: Params): string => {\n  return params[\"itemId\"] || params[\"cipherId\"];\n};\n","import { NgModule } from \"@angular/core\";\nimport { RouterModule, Routes } from \"@angular/router\";\n\nimport { canAccessVaultTab } from \"@bitwarden/common/admin-console/abstractions/organization/organization.service.abstraction\";\n\nimport { OrganizationPermissionsGuard } from \"../../admin-console/organizations/guards/org-permissions.guard\";\n\nimport { VaultComponent } from \"./vault.component\";\nconst routes: Routes = [\n  {\n    path: \"\",\n    component: VaultComponent,\n    canActivate: [OrganizationPermissionsGuard],\n    data: { titleId: \"vaults\", organizationPermissions: canAccessVaultTab },\n  },\n];\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class VaultRoutingModule {}\n","import { NgModule } from \"@angular/core\";\n\nimport { BreadcrumbsModule } from \"@bitwarden/components\";\n\nimport { LooseComponentsModule } from \"../../shared/loose-components.module\";\nimport { SharedModule } from \"../../shared/shared.module\";\nimport { OrganizationBadgeModule } from \"../../vault/individual-vault/organization-badge/organization-badge.module\";\nimport { PipesModule } from \"../../vault/individual-vault/pipes/pipes.module\";\nimport { VaultItemsModule } from \"../components/vault-items/vault-items.module\";\n\nimport { CollectionBadgeModule } from \"./collection-badge/collection-badge.module\";\nimport { GroupBadgeModule } from \"./group-badge/group-badge.module\";\nimport { VaultFilterModule } from \"./vault-filter/vault-filter.module\";\nimport { VaultHeaderComponent } from \"./vault-header/vault-header.component\";\nimport { VaultRoutingModule } from \"./vault-routing.module\";\nimport { VaultComponent } from \"./vault.component\";\n\n@NgModule({\n  imports: [\n    VaultRoutingModule,\n    VaultFilterModule,\n    SharedModule,\n    LooseComponentsModule,\n    GroupBadgeModule,\n    CollectionBadgeModule,\n    OrganizationBadgeModule,\n    PipesModule,\n    BreadcrumbsModule,\n    VaultItemsModule,\n  ],\n  declarations: [VaultComponent, VaultHeaderComponent],\n  exports: [VaultComponent],\n})\nexport class VaultModule {}\n","import { NgModule } from \"@angular/core\";\nimport { RouterModule, Routes } from \"@angular/router\";\n\nimport { AuthGuard } from \"@bitwarden/angular/auth/guards/auth.guard\";\nimport {\n  canAccessOrgAdmin,\n  canAccessGroupsTab,\n  canAccessMembersTab,\n  canAccessVaultTab,\n  canAccessReportingTab,\n  canAccessSettingsTab,\n} from \"@bitwarden/common/admin-console/abstractions/organization/organization.service.abstraction\";\nimport { Organization } from \"@bitwarden/common/admin-console/models/domain/organization\";\n\nimport { OrganizationPermissionsGuard } from \"../../admin-console/organizations/guards/org-permissions.guard\";\nimport { OrganizationRedirectGuard } from \"../../admin-console/organizations/guards/org-redirect.guard\";\nimport { OrganizationLayoutComponent } from \"../../admin-console/organizations/layouts/organization-layout.component\";\nimport { GroupsComponent } from \"../../admin-console/organizations/manage/groups.component\";\nimport { VaultModule } from \"../../vault/org-vault/vault.module\";\n\nconst routes: Routes = [\n  {\n    path: \":organizationId\",\n    component: OrganizationLayoutComponent,\n    canActivate: [AuthGuard, OrganizationPermissionsGuard],\n    data: {\n      organizationPermissions: canAccessOrgAdmin,\n    },\n    children: [\n      {\n        path: \"\",\n        pathMatch: \"full\",\n        canActivate: [OrganizationRedirectGuard],\n        data: {\n          autoRedirectCallback: getOrganizationRoute,\n        },\n        children: [], // This is required to make the auto redirect work, },\n      },\n      {\n        path: \"vault\",\n        loadChildren: () => VaultModule,\n      },\n      {\n        path: \"settings\",\n        loadChildren: () =>\n          import(\"./settings/organization-settings.module\").then(\n            (m) => m.OrganizationSettingsModule\n          ),\n      },\n      {\n        path: \"members\",\n        loadChildren: () => import(\"./members\").then((m) => m.MembersModule),\n      },\n      {\n        path: \"groups\",\n        component: GroupsComponent,\n        canActivate: [OrganizationPermissionsGuard],\n        data: {\n          titleId: \"groups\",\n          organizationPermissions: canAccessGroupsTab,\n        },\n      },\n      {\n        path: \"reporting\",\n        loadChildren: () =>\n          import(\"../organizations/reporting/organization-reporting.module\").then(\n            (m) => m.OrganizationReportingModule\n          ),\n      },\n      {\n        path: \"billing\",\n        loadChildren: () =>\n          import(\"../../billing/organizations/organization-billing.module\").then(\n            (m) => m.OrganizationBillingModule\n          ),\n      },\n    ],\n  },\n];\n\nfunction getOrganizationRoute(organization: Organization): string {\n  if (canAccessVaultTab(organization)) {\n    return \"vault\";\n  }\n  if (canAccessMembersTab(organization)) {\n    return \"members\";\n  }\n  if (canAccessGroupsTab(organization)) {\n    return \"groups\";\n  }\n  if (canAccessReportingTab(organization)) {\n    return \"reporting\";\n  }\n  if (canAccessSettingsTab(organization)) {\n    return \"settings\";\n  }\n  return undefined;\n}\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class OrganizationsRoutingModule {}\n","import { NgModule } from \"@angular/core\";\n\nimport { CoreOrganizationModule } from \"./core\";\nimport { GroupAddEditComponent } from \"./manage/group-add-edit.component\";\nimport { GroupsComponent } from \"./manage/groups.component\";\nimport { OrganizationsRoutingModule } from \"./organization-routing.module\";\nimport { SharedOrganizationModule } from \"./shared\";\nimport { AccessSelectorModule } from \"./shared/components/access-selector\";\n\n@NgModule({\n  imports: [\n    SharedOrganizationModule,\n    AccessSelectorModule,\n    CoreOrganizationModule,\n    OrganizationsRoutingModule,\n  ],\n  declarations: [GroupsComponent, GroupAddEditComponent],\n})\nexport class OrganizationModule {}\n","import { AbstractControl, FormArray } from \"@angular/forms\";\n\nexport type SelectionItemId = {\n  id: string;\n};\n\nfunction findSortedIndex<T>(sortedArray: T[], val: T, compareFn: (a: T, b: T) => number) {\n  let low = 0;\n  let high = sortedArray.length || 0;\n  let mid = -1,\n    c = 0;\n  while (low < high) {\n    mid = Math.floor((low + high) / 2);\n    c = compareFn(sortedArray[mid], val);\n    if (c < 0) {\n      low = mid + 1;\n    } else if (c > 0) {\n      high = mid;\n    } else {\n      return mid;\n    }\n  }\n  return low;\n}\n\n/**\n * Utility to help manage a list of selectable items for use with Reactive Angular forms and FormArrays.\n *\n * It supports selecting/deselecting items, keeping items sorted, and synchronizing the selected items\n * with an array of FormControl.\n *\n * The first type parameter TItem represents the item being selected/deselected, it must have an `id`\n * property for identification/comparison. The second type parameter TControlValue represents the value\n * type of the form control.\n */\nexport class FormSelectionList<\n  TItem extends SelectionItemId,\n  TControlValue extends SelectionItemId\n> {\n  allItems: TItem[] = [];\n  /**\n   * Sorted list of selected items\n   * Immutable and should be recreated whenever a modification is made\n   */\n  selectedItems: TItem[] = [];\n\n  /**\n   * Sorted list of deselected items\n   * Immutable and should be recreated whenever a modification is made\n   */\n  deselectedItems: TItem[] = [];\n\n  /**\n   * Sorted FormArray that corresponds and stays in sync with the selectedItems\n   */\n  formArray: FormArray<AbstractControl<Partial<TControlValue>, TControlValue>> = new FormArray([]);\n\n  /**\n   * Construct a new FormSelectionList\n   * @param controlFactory - Factory responsible for creating initial form controls for each selected item. It is\n   * provided a copy of the selected item for any form control initialization logic. Specify any additional form\n   * control options or validators here.\n   * @param compareFn - Comparison function used for sorting the items.\n   */\n  constructor(\n    private controlFactory: (item: TItem) => AbstractControl<Partial<TControlValue>, TControlValue>,\n    private compareFn: (a: TItem, b: TItem) => number\n  ) {}\n\n  /**\n   * Select multiple items by their ids at once. Optionally provide an initial form control value.\n   * @param ids - List of ids to select\n   * @param initialValue - Value that will be applied to the corresponding form controls\n   * The provided `id` arguments will be automatically assigned to each form control value\n   */\n  selectItems(ids: string[], initialValue?: Partial<TControlValue> | undefined) {\n    for (const id of ids) {\n      this.selectItem(id, initialValue);\n    }\n  }\n\n  /**\n   * Deselect multiple items by their ids at once\n   * @param ids - List of ids to deselect\n   */\n  deselectItems(ids: string[]) {\n    for (const id of ids) {\n      this.deselectItem(id);\n    }\n  }\n\n  deselectAll() {\n    this.formArray.clear();\n    this.selectedItems = [];\n    this.deselectedItems = [...this.allItems];\n  }\n\n  /**\n   * Select a single item by id.\n   *\n   * Maintains list order for both selected items, deselected items, and the FormArray.\n   *\n   * @param id - Id of the item to select\n   * @param initialValue - Value that will be applied to the corresponding form control for the selected item.\n   * The provided `id` argument will be automatically assigned unless explicitly set in the initialValue.\n   */\n  selectItem(id: string, initialValue?: Partial<TControlValue>) {\n    const index = this.deselectedItems.findIndex((o) => o.id === id);\n\n    if (index === -1) {\n      return;\n    }\n\n    const selectedOption = this.deselectedItems[index];\n\n    // Note: Changes to the deselected/selected arrays must create a new copy of the array\n    // in order for Angular's Change Detection to pick up the modification (i.e. treat the arrays as immutable)\n\n    // Remove from the list of deselected options\n    this.deselectedItems = [\n      ...this.deselectedItems.slice(0, index),\n      ...this.deselectedItems.slice(index + 1),\n    ];\n\n    // Insert into the sorted selected options list\n    const sortedInsertIndex = findSortedIndex(this.selectedItems, selectedOption, this.compareFn);\n\n    this.selectedItems = [\n      ...this.selectedItems.slice(0, sortedInsertIndex),\n      selectedOption,\n      ...this.selectedItems.slice(sortedInsertIndex),\n    ];\n\n    const newControl = this.controlFactory(selectedOption);\n\n    // Patch the value and ensure the `id` is set\n    newControl.patchValue({\n      id,\n      ...initialValue,\n    });\n\n    this.formArray.insert(sortedInsertIndex, newControl);\n  }\n\n  /**\n   * Deselect a single item by id.\n   *\n   * Maintains list order for both selected items, deselected items, and the FormArray.\n   *\n   * @param id - Id of the item to deselect\n   */\n  deselectItem(id: string) {\n    const index = this.selectedItems.findIndex((o) => o.id === id);\n\n    if (index === -1) {\n      return;\n    }\n\n    const deselectedOption = this.selectedItems[index];\n\n    // Note: Changes to the deselected/selected arrays must create a new copy of the array\n    // in order for Angular's Change Detection to pick up the modification (i.e. treat the arrays as immutable)\n\n    // Remove from the list of selected items (and FormArray)\n    this.selectedItems = [\n      ...this.selectedItems.slice(0, index),\n      ...this.selectedItems.slice(index + 1),\n    ];\n    this.formArray.removeAt(index);\n\n    // Insert into the sorted deselected array\n    const sortedInsertIndex = findSortedIndex(\n      this.deselectedItems,\n      deselectedOption,\n      this.compareFn\n    );\n\n    this.deselectedItems = [\n      ...this.deselectedItems.slice(0, sortedInsertIndex),\n      deselectedOption,\n      ...this.deselectedItems.slice(sortedInsertIndex),\n    ];\n  }\n\n  /**\n   * Populate the list of deselected items, and optional specify which items should be selected and with what initial\n   * value for their Form Control\n   * @param items - A list of all items. (Will be sorted internally)\n   * @param selectedItems - The items to select initially\n   */\n  populateItems(items: TItem[], selectedItems: TControlValue[] = []) {\n    this.formArray.clear();\n    this.allItems = [...items].sort(this.compareFn);\n    this.selectedItems = [];\n    this.deselectedItems = [...this.allItems];\n\n    for (const selectedItem of selectedItems) {\n      this.selectItem(selectedItem.id, selectedItem);\n    }\n  }\n\n  /**\n   * Helper method to iterate over each \"selected\" form control and its corresponding item\n   * @param fn - The function to call for each form control and its corresponding item\n   */\n  forEachControlItem(\n    fn: (control: AbstractControl<Partial<TControlValue>, TControlValue>, value: TItem) => void\n  ) {\n    for (let i = 0; i < this.formArray.length; i++) {\n      // The selectedItems array and formArray are explicitly kept in sync,\n      // so we can safely assume the index of the form control and item are the same\n      fn(this.formArray.at(i), this.selectedItems[i]);\n    }\n  }\n}\n","import { Pipe, PipeTransform } from \"@angular/core\";\n\nimport { I18nService } from \"@bitwarden/common/abstractions/i18n.service\";\nimport { OrganizationUserType } from \"@bitwarden/common/admin-console/enums\";\n\n@Pipe({\n  name: \"userType\",\n})\nexport class UserTypePipe implements PipeTransform {\n  constructor(private i18nService: I18nService) {}\n\n  transform(value?: OrganizationUserType, unknownText?: string): string {\n    if (value == null) {\n      return unknownText ?? this.i18nService.t(\"unknown\");\n    }\n    switch (value) {\n      case OrganizationUserType.Owner:\n        return this.i18nService.t(\"owner\");\n      case OrganizationUserType.Admin:\n        return this.i18nService.t(\"admin\");\n      case OrganizationUserType.User:\n        return this.i18nService.t(\"user\");\n      case OrganizationUserType.Manager:\n        return this.i18nService.t(\"manager\");\n      case OrganizationUserType.Custom:\n        return this.i18nService.t(\"custom\");\n    }\n  }\n}\n","<!-- Please remove this disable statement when editing this file! -->\n<!-- eslint-disable tailwindcss/no-custom-classname -->\n<div class=\"tw-flex\">\n  <bit-form-field *ngIf=\"permissionMode == 'edit'\" class=\"tw-mr-3 tw-shrink-0\">\n    <bit-label>{{ \"permission\" | i18n }}</bit-label>\n    <!--\n      Built-in select height differs between browsers, this fix makes sure we match bit-multi-select height.\n      We might want to reconsider this fix when/if we implement\n      [CL-78] [Improvement] Completely restyled selects (https://bitwarden.atlassian.net/browse/CL-78)\n    -->\n    <select\n      class=\"tw-h-[35px]\"\n      bitInput\n      [disabled]=\"disabled\"\n      [(ngModel)]=\"initialPermission\"\n      [ngModelOptions]=\"{ standalone: true }\"\n      (blur)=\"handleBlur()\"\n    >\n      <option *ngFor=\"let p of permissionList\" [value]=\"p.perm\">\n        {{ p.labelId | i18n }}\n      </option>\n    </select>\n  </bit-form-field>\n\n  <bit-form-field class=\"tw-grow\">\n    <bit-label>{{ selectorLabelText }}</bit-label>\n    <bit-multi-select\n      class=\"tw-w-full\"\n      [baseItems]=\"selectionList.deselectedItems\"\n      [removeSelectedItems]=\"true\"\n      [disabled]=\"disabled\"\n      (onItemsConfirmed)=\"selectItems($event)\"\n      (blur)=\"handleBlur()\"\n    ></bit-multi-select>\n    <bit-hint *ngIf=\"selectorHelpText\">{{ selectorHelpText }}</bit-hint>\n  </bit-form-field>\n</div>\n\n<bit-table [formGroup]=\"formGroup\">\n  <ng-container header>\n    <tr>\n      <th bitCell>{{ columnHeader }}</th>\n      <th bitCell id=\"permissionColHeading\" *ngIf=\"permissionMode != 'hidden'\">\n        <div class=\"tw-border tw-border-solid tw-border-transparent\">\n          {{ \"permission\" | i18n }}\n        </div>\n      </th>\n      <th bitCell id=\"roleColHeading\" *ngIf=\"showMemberRoles\">{{ \"role\" | i18n }}</th>\n      <th bitCell id=\"groupColHeading\" *ngIf=\"showGroupColumn\">{{ \"group\" | i18n }}</th>\n      <th bitCell class=\"tw-w-20\"></th>\n    </tr>\n  </ng-container>\n  <ng-template body formArrayName=\"items\">\n    <tr\n      bitRow\n      *ngFor=\"let item of selectionList.selectedItems; let i = index\"\n      [formGroupName]=\"i\"\n      [ngClass]=\"{ 'tw-text-muted': item.readonly }\"\n    >\n      <td bitCell [ngSwitch]=\"item.type\">\n        <div class=\"tw-flex tw-items-center\" *ngSwitchCase=\"itemType.Member\">\n          <bit-avatar size=\"small\" class=\"tw-mr-3\" text=\"{{ item.labelName }}\"></bit-avatar>\n          <div class=\"tw-flex tw-flex-col\">\n            <div>\n              {{ item.labelName }}\n              <span *ngIf=\"$any(item).status == 0\" bitBadge badgeType=\"secondary\">\n                {{ \"invited\" | i18n }}\n              </span>\n            </div>\n            <div class=\"tw-text-xs tw-text-muted\" *ngIf=\"$any(item).status != 0\">\n              {{ $any(item).email }}\n            </div>\n          </div>\n        </div>\n\n        <div class=\"tw-flex tw-items-center\" *ngSwitchDefault>\n          <i\n            class=\"bwi tw-mr-3 tw-px-0.5 tw-text-2xl\"\n            [ngClass]=\"item.icon || itemIcon(item)\"\n            aria-hidden=\"true\"\n          ></i>\n          <span>{{ item.labelName }}</span>\n        </div>\n      </td>\n\n      <td bitCell *ngIf=\"permissionMode != 'hidden'\">\n        <ng-container *ngIf=\"canEditItemPermission(item); else readOnlyPerm\">\n          <label class=\"sr-only\" [for]=\"'permission' + i\"\n            >{{ item.labelName }} {{ \"permission\" | i18n }}</label\n          >\n          <div class=\"tw-relative tw-inline-block\">\n            <select\n              bitInput\n              class=\"tw-apperance-none -tw-ml-3 tw-max-w-40 tw-appearance-none tw-overflow-ellipsis !tw-rounded tw-border-transparent !tw-bg-transparent tw-pr-6 tw-font-bold hover:tw-border-primary-700\"\n              formControlName=\"permission\"\n              [id]=\"'permission' + i\"\n              (blur)=\"handleBlur()\"\n            >\n              <option *ngFor=\"let p of permissionList\" [value]=\"p.perm\">\n                {{ p.labelId | i18n }}\n              </option>\n            </select>\n            <label\n              [for]=\"'permission' + i\"\n              class=\"tw-absolute tw-inset-y-0 tw-right-4 tw-mb-0 tw-flex tw-items-center\"\n            >\n              <i class=\"bwi bwi-sm bwi-angle-down tw-leading-[0]\"></i>\n            </label>\n          </div>\n        </ng-container>\n\n        <ng-template #readOnlyPerm>\n          <div\n            *ngIf=\"item.accessAllItems\"\n            class=\"tw-max-w-40 tw-overflow-hidden tw-overflow-ellipsis tw-whitespace-nowrap tw-border tw-border-solid tw-border-transparent tw-font-bold tw-text-muted\"\n            [appA11yTitle]=\"accessAllLabelId(item) | i18n\"\n          >\n            {{ \"canEdit\" | i18n }}\n            <i class=\"bwi bwi-filter tw-ml-1\" aria-hidden=\"true\"></i>\n          </div>\n\n          <div\n            *ngIf=\"item.readonly\"\n            class=\"tw-max-w-40 tw-overflow-hidden tw-overflow-ellipsis tw-whitespace-nowrap tw-font-bold tw-text-muted\"\n            [title]=\"permissionLabelId(item.readonlyPermission) | i18n\"\n          >\n            {{ permissionLabelId(item.readonlyPermission) | i18n }}\n          </div>\n        </ng-template>\n      </td>\n\n      <td bitCell *ngIf=\"showMemberRoles\">\n        {{ $any(item).role | userType : \"-\" }}\n      </td>\n\n      <td bitCell *ngIf=\"showGroupColumn\">\n        {{ $any(item).viaGroupName ?? \"-\" }}\n      </td>\n\n      <td bitCell class=\"tw-text-right\">\n        <button\n          *ngIf=\"!item.readonly\"\n          type=\"button\"\n          bitIconButton=\"bwi-close\"\n          buttonType=\"muted\"\n          appA11yTitle=\"{{ 'remove' | i18n }} {{ item.labelName }}\"\n          [disabled]=\"disabled\"\n          (click)=\"selectionList.deselectItem(item.id); handleBlur()\"\n        ></button>\n      </td>\n    </tr>\n    <tr *ngIf=\"selectionList.selectedItems.length == 0\">\n      <td bitCell>{{ emptySelectionText }}</td>\n    </tr>\n  </ng-template>\n</bit-table>\n","import { Component, forwardRef, Input, OnDestroy, OnInit } from \"@angular/core\";\nimport {\n  ControlValueAccessor,\n  FormBuilder,\n  FormControl,\n  FormGroup,\n  NG_VALUE_ACCESSOR,\n} from \"@angular/forms\";\nimport { Subject, takeUntil } from \"rxjs\";\n\nimport { ControlsOf } from \"@bitwarden/angular/types/controls-of\";\nimport { FormSelectionList } from \"@bitwarden/angular/utils/form-selection-list\";\nimport { I18nService } from \"@bitwarden/common/abstractions/i18n.service\";\nimport { SelectItemView } from \"@bitwarden/components/src/multi-select/models/select-item-view\";\n\nimport {\n  AccessItemType,\n  AccessItemValue,\n  AccessItemView,\n  CollectionPermission,\n} from \"./access-selector.models\";\n\nexport enum PermissionMode {\n  /**\n   * No permission controls or column present. No permission values are emitted.\n   */\n  Hidden = \"hidden\",\n\n  /**\n   * No permission controls. Column rendered an if available on an item. No permission values are emitted\n   */\n  Readonly = \"readonly\",\n\n  /**\n   * Permission Controls and column present. Permission values are emitted.\n   */\n  Edit = \"edit\",\n}\n\n@Component({\n  selector: \"bit-access-selector\",\n  templateUrl: \"access-selector.component.html\",\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      useExisting: forwardRef(() => AccessSelectorComponent),\n      multi: true,\n    },\n  ],\n})\nexport class AccessSelectorComponent implements ControlValueAccessor, OnInit, OnDestroy {\n  private destroy$ = new Subject<void>();\n  private notifyOnChange: (v: unknown) => void;\n  private notifyOnTouch: () => void;\n  private pauseChangeNotification: boolean;\n\n  /**\n   * Updates the enabled/disabled state of provided row form group based on the item's readonly state.\n   * If a row is enabled, it also updates the enabled/disabled state of the permission control\n   * based on the item's accessAllItems state and the current value of `permissionMode`.\n   * @param controlRow - The form group for the row to update\n   * @param item - The access item that is represented by the row\n   */\n  private updateRowControlDisableState = (\n    controlRow: FormGroup<ControlsOf<AccessItemValue>>,\n    item: AccessItemView\n  ) => {\n    // Disable entire row form group if readonly\n    if (item.readonly) {\n      controlRow.disable();\n    } else {\n      controlRow.enable();\n\n      // The enable() above also enables the permission control, so we need to disable it again\n      // Disable permission control if accessAllItems is enabled or not in Edit mode\n      if (item.accessAllItems || this.permissionMode != PermissionMode.Edit) {\n        controlRow.controls.permission.disable();\n      }\n    }\n  };\n\n  /**\n   * Updates the enabled/disabled state of ALL row form groups based on each item's readonly state.\n   */\n  private updateAllRowControlDisableStates = () => {\n    this.selectionList.forEachControlItem((controlRow, item) => {\n      this.updateRowControlDisableState(controlRow as FormGroup<ControlsOf<AccessItemValue>>, item);\n    });\n  };\n\n  /**\n   * The internal selection list that tracks the value of this form control / component.\n   * It's responsible for keeping items sorted and synced with the rendered form controls\n   * @protected\n   */\n  protected selectionList = new FormSelectionList<AccessItemView, AccessItemValue>((item) => {\n    const permissionControl = this.formBuilder.control(this.initialPermission);\n\n    const fg = this.formBuilder.group<ControlsOf<AccessItemValue>>({\n      id: new FormControl(item.id),\n      type: new FormControl(item.type),\n      permission: permissionControl,\n    });\n\n    this.updateRowControlDisableState(fg, item);\n\n    return fg;\n  }, this._itemComparator.bind(this));\n\n  /**\n   * Internal form group for this component.\n   * @protected\n   */\n  protected formGroup = this.formBuilder.group({\n    items: this.selectionList.formArray,\n  });\n\n  protected itemType = AccessItemType;\n  protected permissionList = [\n    { perm: CollectionPermission.View, labelId: \"canView\" },\n    { perm: CollectionPermission.ViewExceptPass, labelId: \"canViewExceptPass\" },\n    { perm: CollectionPermission.Edit, labelId: \"canEdit\" },\n    { perm: CollectionPermission.EditExceptPass, labelId: \"canEditExceptPass\" },\n  ];\n  protected initialPermission = CollectionPermission.View;\n\n  disabled: boolean;\n\n  /**\n   * List of all selectable items that. Sorted internally.\n   */\n  @Input()\n  get items(): AccessItemView[] {\n    return this.selectionList.allItems;\n  }\n\n  set items(val: AccessItemView[]) {\n    const selected = (this.selectionList.formArray.getRawValue() ?? []).concat(\n      val.filter((m) => m.readonly)\n    );\n    this.selectionList.populateItems(\n      val.map((m) => {\n        m.icon = m.icon ?? this.itemIcon(m); // Ensure an icon is set\n        return m;\n      }),\n      selected\n    );\n  }\n\n  /**\n   * Permission mode that controls if the permission form controls and column should be present.\n   */\n  @Input()\n  get permissionMode(): PermissionMode {\n    return this._permissionMode;\n  }\n\n  set permissionMode(value: PermissionMode) {\n    this._permissionMode = value;\n    // Update any internal permission controls\n    this.updateAllRowControlDisableStates();\n  }\n  private _permissionMode: PermissionMode = PermissionMode.Hidden;\n\n  /**\n   * Column header for the selected items table\n   */\n  @Input() columnHeader: string;\n\n  /**\n   * Label used for the ng selector\n   */\n  @Input() selectorLabelText: string;\n\n  /**\n   * Helper text displayed under the ng selector\n   */\n  @Input() selectorHelpText: string;\n\n  /**\n   * Text that is shown in the table when no items are selected\n   */\n  @Input() emptySelectionText: string;\n\n  /**\n   * Flag for if the member roles column should be present\n   */\n  @Input() showMemberRoles: boolean;\n\n  /**\n   * Flag for if the group column should be present\n   */\n  @Input() showGroupColumn: boolean;\n\n  constructor(\n    private readonly formBuilder: FormBuilder,\n    private readonly i18nService: I18nService\n  ) {}\n\n  /** Required for NG_VALUE_ACCESSOR */\n  registerOnChange(fn: any): void {\n    this.notifyOnChange = fn;\n  }\n\n  /** Required for NG_VALUE_ACCESSOR */\n  registerOnTouched(fn: any): void {\n    this.notifyOnTouch = fn;\n  }\n\n  /** Required for NG_VALUE_ACCESSOR */\n  setDisabledState(isDisabled: boolean): void {\n    this.disabled = isDisabled;\n\n    // Keep the internal FormGroup in sync\n    if (this.disabled) {\n      this.formGroup.disable();\n    } else {\n      this.formGroup.enable();\n\n      // The enable() above automatically enables all the row controls,\n      // so we need to disable the readonly ones again\n      this.updateAllRowControlDisableStates();\n    }\n  }\n\n  /** Required for NG_VALUE_ACCESSOR */\n  writeValue(selectedItems: AccessItemValue[]): void {\n    // Modifying the selection list, mistakenly fires valueChanges in the\n    // internal form array, so we need to know to pause external notification\n    this.pauseChangeNotification = true;\n\n    // Always clear the internal selection list on a new value\n    this.selectionList.deselectAll();\n\n    // We need to also select any read only items to appear in the table\n    this.selectionList.selectItems(this.items.filter((m) => m.readonly).map((m) => m.id));\n\n    // If the new value is null, then we're done\n    if (selectedItems == null) {\n      this.pauseChangeNotification = false;\n      return;\n    }\n\n    // Unable to handle other value types, throw\n    if (!Array.isArray(selectedItems)) {\n      throw new Error(\"The access selector component only supports Array form values!\");\n    }\n\n    // Iterate and internally select each item\n    for (const value of selectedItems) {\n      this.selectionList.selectItem(value.id, value);\n    }\n\n    this.pauseChangeNotification = false;\n  }\n\n  ngOnInit() {\n    // Watch the internal formArray for changes and propagate them\n    this.selectionList.formArray.valueChanges.pipe(takeUntil(this.destroy$)).subscribe((v) => {\n      if (!this.notifyOnChange || this.pauseChangeNotification) {\n        return;\n      }\n      // Disabled form arrays emit values for disabled controls, we override this to emit an empty array to avoid\n      // emitting values for disabled controls that are \"readonly\" in the table\n      if (this.selectionList.formArray.disabled) {\n        this.notifyOnChange([]);\n        return;\n      }\n      this.notifyOnChange(v);\n    });\n  }\n\n  ngOnDestroy() {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n\n  protected handleBlur() {\n    if (!this.notifyOnTouch) {\n      return;\n    }\n\n    this.notifyOnTouch();\n  }\n\n  protected selectItems(items: SelectItemView[]) {\n    this.pauseChangeNotification = true;\n    this.selectionList.selectItems(items.map((i) => i.id));\n    this.pauseChangeNotification = false;\n    if (this.notifyOnChange != undefined) {\n      this.notifyOnChange(this.selectionList.formArray.value);\n    }\n  }\n\n  protected itemIcon(item: AccessItemView) {\n    switch (item.type) {\n      case AccessItemType.Collection:\n        return \"bwi-collection\";\n      case AccessItemType.Group:\n        return \"bwi-users\";\n      case AccessItemType.Member:\n        return \"bwi-user\";\n    }\n  }\n\n  protected permissionLabelId(perm: CollectionPermission) {\n    return this.permissionList.find((p) => p.perm == perm)?.labelId;\n  }\n\n  protected accessAllLabelId(item: AccessItemView) {\n    return item.type == AccessItemType.Group ? \"groupAccessAll\" : \"memberAccessAll\";\n  }\n\n  protected canEditItemPermission(item: AccessItemView) {\n    return this.permissionMode == PermissionMode.Edit && !item.readonly && !item.accessAllItems;\n  }\n\n  private _itemComparator(a: AccessItemView, b: AccessItemView) {\n    return (\n      a.type - b.type ||\n      this.i18nService.collator.compare(a.listName, b.listName) ||\n      this.i18nService.collator.compare(a.labelName, b.labelName) ||\n      Number(b.readonly) - Number(a.readonly)\n    );\n  }\n}\n","import {\n  OrganizationUserStatusType,\n  OrganizationUserType,\n} from \"@bitwarden/common/admin-console/enums\";\nimport { SelectItemView } from \"@bitwarden/components\";\n\nimport { CollectionAccessSelectionView } from \"../../../core\";\n\n/**\n * Permission options that replace/correspond with readOnly and hidePassword server fields.\n */\nexport enum CollectionPermission {\n  View = \"view\",\n  ViewExceptPass = \"viewExceptPass\",\n  Edit = \"edit\",\n  EditExceptPass = \"editExceptPass\",\n}\n\nexport enum AccessItemType {\n  Collection,\n  Group,\n  Member,\n}\n\n/**\n * A \"generic\" type that describes an item that can be selected from a\n * ng-select list and have its collection permission modified.\n *\n * Currently, it supports Collections, Groups, and Members. Members require some additional\n * details to render in the AccessSelectorComponent so their type is defined separately\n * and then joined back with the base type.\n *\n */\nexport type AccessItemView =\n  | SelectItemView & {\n      /**\n       * Flag that this group/member can access all items.\n       * This will disable the permission editor for this item.\n       */\n      accessAllItems?: boolean;\n\n      /**\n       * Flag that this item cannot be modified.\n       * This will disable the permission editor and will keep\n       * the item always selected.\n       */\n      readonly?: boolean;\n\n      /**\n       * Optional permission that will be rendered for this\n       * item if it set to readonly.\n       */\n      readonlyPermission?: CollectionPermission;\n    } & (\n        | {\n            type: AccessItemType.Collection;\n            viaGroupName?: string;\n          }\n        | {\n            type: AccessItemType.Group;\n          }\n        | {\n            type: AccessItemType.Member; // Members have a few extra details required to display, so they're added here\n            email: string;\n            role: OrganizationUserType;\n            status: OrganizationUserStatusType;\n          }\n      );\n\n/**\n * A type that is emitted as a value for the ngControl\n */\nexport type AccessItemValue = {\n  id: string;\n  permission?: CollectionPermission;\n  type: AccessItemType;\n};\n\n/**\n * Converts the CollectionAccessSelectionView interface to one of the new CollectionPermission values\n * for the dropdown in the AccessSelectorComponent\n * @param value\n */\nexport const convertToPermission = (value: CollectionAccessSelectionView) => {\n  if (value.readOnly) {\n    return value.hidePasswords ? CollectionPermission.ViewExceptPass : CollectionPermission.View;\n  } else {\n    return value.hidePasswords ? CollectionPermission.EditExceptPass : CollectionPermission.Edit;\n  }\n};\n\n/**\n * Converts an AccessItemValue back into a CollectionAccessView class using the CollectionPermission\n * to determine the values for `readOnly` and `hidePassword`\n * @param value\n */\nexport const convertToSelectionView = (value: AccessItemValue) => {\n  return new CollectionAccessSelectionView({\n    id: value.id,\n    readOnly: readOnly(value.permission),\n    hidePasswords: hidePassword(value.permission),\n  });\n};\n\nconst readOnly = (perm: CollectionPermission) =>\n  [CollectionPermission.View, CollectionPermission.ViewExceptPass].includes(perm);\n\nconst hidePassword = (perm: CollectionPermission) =>\n  [CollectionPermission.ViewExceptPass, CollectionPermission.EditExceptPass].includes(perm);\n","import { NgModule } from \"@angular/core\";\n\nimport { SharedModule } from \"../../../../../shared\";\n\nimport { AccessSelectorComponent } from \"./access-selector.component\";\nimport { UserTypePipe } from \"./user-type.pipe\";\n\n@NgModule({\n  imports: [SharedModule],\n  declarations: [AccessSelectorComponent, UserTypePipe],\n  exports: [AccessSelectorComponent],\n})\nexport class AccessSelectorModule {}\n","import { DIALOG_DATA, DialogConfig, DialogRef } from \"@angular/cdk/dialog\";\nimport { Component, Inject, OnDestroy, OnInit } from \"@angular/core\";\nimport { FormBuilder, Validators } from \"@angular/forms\";\nimport { combineLatest, of, shareReplay, Subject, switchMap, takeUntil } from \"rxjs\";\n\nimport { DialogServiceAbstraction, SimpleDialogType } from \"@bitwarden/angular/services/dialog\";\nimport { I18nService } from \"@bitwarden/common/abstractions/i18n.service\";\nimport { OrganizationUserService } from \"@bitwarden/common/abstractions/organization-user/organization-user.service\";\nimport { OrganizationUserUserDetailsResponse } from \"@bitwarden/common/abstractions/organization-user/responses\";\nimport { PlatformUtilsService } from \"@bitwarden/common/abstractions/platformUtils.service\";\nimport { OrganizationService } from \"@bitwarden/common/admin-console/abstractions/organization/organization.service.abstraction\";\nimport { Organization } from \"@bitwarden/common/admin-console/models/domain/organization\";\nimport { CollectionView } from \"@bitwarden/common/admin-console/models/view/collection.view\";\nimport { BitValidators } from \"@bitwarden/components\";\n\nimport {\n  CollectionAdminService,\n  CollectionAdminView,\n  GroupService,\n  GroupView,\n} from \"../../../core\";\nimport {\n  AccessItemType,\n  AccessItemValue,\n  AccessItemView,\n  convertToPermission,\n  convertToSelectionView,\n  PermissionMode,\n} from \"../access-selector\";\n\nexport enum CollectionDialogTabType {\n  Info = 0,\n  Access = 1,\n}\n\nexport interface CollectionDialogParams {\n  collectionId?: string;\n  organizationId: string;\n  initialTab?: CollectionDialogTabType;\n  parentCollectionId?: string;\n}\n\nexport enum CollectionDialogResult {\n  Saved = \"saved\",\n  Canceled = \"canceled\",\n  Deleted = \"deleted\",\n}\n\n@Component({\n  templateUrl: \"collection-dialog.component.html\",\n})\nexport class CollectionDialogComponent implements OnInit, OnDestroy {\n  private destroy$ = new Subject<void>();\n\n  protected tabIndex: CollectionDialogTabType;\n  protected loading = true;\n  protected organization?: Organization;\n  protected collection?: CollectionView;\n  protected nestOptions: CollectionView[] = [];\n  protected accessItems: AccessItemView[] = [];\n  protected deletedParentName: string | undefined;\n  protected formGroup = this.formBuilder.group({\n    name: [\"\", [Validators.required, BitValidators.forbiddenCharacters([\"/\"])]],\n    externalId: \"\",\n    parent: undefined as string | undefined,\n    access: [[] as AccessItemValue[]],\n  });\n  protected PermissionMode = PermissionMode;\n\n  constructor(\n    @Inject(DIALOG_DATA) private params: CollectionDialogParams,\n    private formBuilder: FormBuilder,\n    private dialogRef: DialogRef<CollectionDialogResult>,\n    private organizationService: OrganizationService,\n    private groupService: GroupService,\n    private collectionService: CollectionAdminService,\n    private i18nService: I18nService,\n    private platformUtilsService: PlatformUtilsService,\n    private organizationUserService: OrganizationUserService,\n    private dialogService: DialogServiceAbstraction\n  ) {\n    this.tabIndex = params.initialTab ?? CollectionDialogTabType.Info;\n  }\n\n  ngOnInit() {\n    const organization$ = of(this.organizationService.get(this.params.organizationId)).pipe(\n      shareReplay({ refCount: true, bufferSize: 1 })\n    );\n    const groups$ = organization$.pipe(\n      switchMap((organization) => {\n        if (!organization.useGroups) {\n          return of([] as GroupView[]);\n        }\n\n        return this.groupService.getAll(this.params.organizationId);\n      })\n    );\n\n    combineLatest({\n      organization: organization$,\n      collections: this.collectionService.getAll(this.params.organizationId),\n      collectionDetails: this.params.collectionId\n        ? this.collectionService.get(this.params.organizationId, this.params.collectionId)\n        : of(null),\n      groups: groups$,\n      users: this.organizationUserService.getAllUsers(this.params.organizationId),\n    })\n      .pipe(takeUntil(this.destroy$))\n      .subscribe(({ organization, collections, collectionDetails, groups, users }) => {\n        this.organization = organization;\n        this.accessItems = [].concat(\n          groups.map(mapGroupToAccessItemView),\n          users.data.map(mapUserToAccessItemView)\n        );\n\n        if (this.params.collectionId) {\n          this.collection = collections.find((c) => c.id === this.collectionId);\n          this.nestOptions = collections.filter((c) => c.id !== this.collectionId);\n\n          if (!this.collection) {\n            throw new Error(\"Could not find collection to edit.\");\n          }\n\n          const { name, parent } = parseName(this.collection);\n          if (parent !== undefined && !this.nestOptions.find((c) => c.name === parent)) {\n            this.deletedParentName = parent;\n          }\n\n          const accessSelections = mapToAccessSelections(collectionDetails);\n          this.formGroup.patchValue({\n            name,\n            externalId: this.collection.externalId,\n            parent,\n            access: accessSelections,\n          });\n        } else {\n          this.nestOptions = collections;\n          const parent = collections.find((c) => c.id === this.params.parentCollectionId);\n          this.formGroup.patchValue({ parent: parent?.name ?? undefined });\n        }\n\n        this.loading = false;\n      });\n  }\n\n  protected get collectionId() {\n    return this.params.collectionId;\n  }\n\n  protected get editMode() {\n    return this.params.collectionId != undefined;\n  }\n\n  protected async cancel() {\n    this.close(CollectionDialogResult.Canceled);\n  }\n\n  protected submit = async () => {\n    this.formGroup.markAllAsTouched();\n\n    if (this.formGroup.invalid) {\n      if (this.tabIndex === CollectionDialogTabType.Access) {\n        this.platformUtilsService.showToast(\n          \"error\",\n          null,\n          this.i18nService.t(\"fieldOnTabRequiresAttention\", this.i18nService.t(\"collectionInfo\"))\n        );\n      }\n      return;\n    }\n\n    const collectionView = new CollectionAdminView();\n    collectionView.id = this.params.collectionId;\n    collectionView.organizationId = this.params.organizationId;\n    collectionView.externalId = this.formGroup.controls.externalId.value;\n    collectionView.groups = this.formGroup.controls.access.value\n      .filter((v) => v.type === AccessItemType.Group)\n      .map(convertToSelectionView);\n    collectionView.users = this.formGroup.controls.access.value\n      .filter((v) => v.type === AccessItemType.Member)\n      .map(convertToSelectionView);\n\n    const parent = this.formGroup.controls.parent.value;\n    if (parent) {\n      collectionView.name = `${parent}/${this.formGroup.controls.name.value}`;\n    } else {\n      collectionView.name = this.formGroup.controls.name.value;\n    }\n\n    await this.collectionService.save(collectionView);\n\n    this.platformUtilsService.showToast(\n      \"success\",\n      null,\n      this.i18nService.t(\n        this.editMode ? \"editedCollectionId\" : \"createdCollectionId\",\n        collectionView.name\n      )\n    );\n\n    this.close(CollectionDialogResult.Saved);\n  };\n\n  protected delete = async () => {\n    const confirmed = await this.dialogService.openSimpleDialog({\n      title: this.collection?.name,\n      content: { key: \"deleteCollectionConfirmation\" },\n      type: SimpleDialogType.WARNING,\n    });\n\n    if (!confirmed && this.params.collectionId) {\n      return false;\n    }\n\n    await this.collectionService.delete(this.params.organizationId, this.params.collectionId);\n\n    this.platformUtilsService.showToast(\n      \"success\",\n      null,\n      this.i18nService.t(\"deletedCollectionId\", this.collection?.name)\n    );\n\n    this.close(CollectionDialogResult.Deleted);\n  };\n\n  ngOnDestroy(): void {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n\n  private close(result: CollectionDialogResult) {\n    this.dialogRef.close(result);\n  }\n}\n\nfunction parseName(collection: CollectionView) {\n  const nameParts = collection.name?.split(\"/\");\n  const name = nameParts[nameParts.length - 1];\n  const parent = nameParts.length > 1 ? nameParts.slice(0, -1).join(\"/\") : undefined;\n\n  return { name, parent };\n}\n\nfunction mapGroupToAccessItemView(group: GroupView): AccessItemView {\n  return {\n    id: group.id,\n    type: AccessItemType.Group,\n    listName: group.name,\n    labelName: group.name,\n    accessAllItems: group.accessAll,\n    readonly: group.accessAll,\n  };\n}\n\n// TODO: Use view when user apis are migrated to a service\nfunction mapUserToAccessItemView(user: OrganizationUserUserDetailsResponse): AccessItemView {\n  return {\n    id: user.id,\n    type: AccessItemType.Member,\n    email: user.email,\n    role: user.type,\n    listName: user.name?.length > 0 ? `${user.name} (${user.email})` : user.email,\n    labelName: user.name ?? user.email,\n    status: user.status,\n    accessAllItems: user.accessAll,\n    readonly: user.accessAll,\n  };\n}\n\nfunction mapToAccessSelections(collectionDetails: CollectionAdminView): AccessItemValue[] {\n  if (collectionDetails == undefined) {\n    return [];\n  }\n  return [].concat(\n    collectionDetails.groups.map<AccessItemValue>((selection) => ({\n      id: selection.id,\n      type: AccessItemType.Group,\n      permission: convertToPermission(selection),\n    })),\n    collectionDetails.users.map<AccessItemValue>((selection) => ({\n      id: selection.id,\n      type: AccessItemType.Member,\n      permission: convertToPermission(selection),\n    }))\n  );\n}\n\n/**\n * Strongly typed helper to open a CollectionDialog\n * @param dialogService Instance of the dialog service that will be used to open the dialog\n * @param config Configuration for the dialog\n */\nexport function openCollectionDialog(\n  dialogService: DialogServiceAbstraction,\n  config: DialogConfig<CollectionDialogParams>\n) {\n  return dialogService.open<CollectionDialogResult, CollectionDialogParams>(\n    CollectionDialogComponent,\n    config\n  );\n}\n","<form [formGroup]=\"formGroup\" [bitSubmit]=\"submit\">\n  <bit-dialog [disablePadding]=\"!loading\" dialogSize=\"large\">\n    <span bitDialogTitle>\n      <ng-container *ngIf=\"editMode\">\n        {{ \"editCollection\" | i18n }}\n        <span class=\"tw-text-sm tw-normal-case tw-text-muted\" *ngIf=\"!loading\">{{\n          collection.name\n        }}</span>\n      </ng-container>\n      <ng-container *ngIf=\"!editMode\">\n        {{ \"newCollection\" | i18n }}\n      </ng-container>\n    </span>\n    <div bitDialogContent>\n      <ng-container *ngIf=\"loading\" #spinner>\n        <i class=\"bwi bwi-spinner bwi-lg bwi-spin\" aria-hidden=\"true\"></i>\n      </ng-container>\n      <bit-tab-group *ngIf=\"!loading\" [(selectedIndex)]=\"tabIndex\">\n        <bit-tab label=\"{{ 'collectionInfo' | i18n }}\">\n          <bit-form-field>\n            <bit-label>{{ \"name\" | i18n }}</bit-label>\n            <input bitInput appAutofocus formControlName=\"name\" />\n          </bit-form-field>\n\n          <bit-form-field>\n            <bit-label>{{ \"externalId\" | i18n }}</bit-label>\n            <input bitInput formControlName=\"externalId\" />\n            <bit-hint>{{ \"externalIdDesc\" | i18n }}</bit-hint>\n          </bit-form-field>\n\n          <bit-form-field>\n            <bit-label>{{ \"nestCollectionUnder\" | i18n }}</bit-label>\n            <bit-select bitInput formControlName=\"parent\">\n              <bit-option [value]=\"undefined\" [label]=\"'noCollection' | i18n\"> </bit-option>\n              <bit-option\n                *ngIf=\"deletedParentName\"\n                disabled\n                icon=\"bwi-collection\"\n                [value]=\"deletedParentName\"\n                label=\"{{ deletedParentName }} ({{ 'deleted' | i18n }})\"\n              >\n              </bit-option>\n              <bit-option\n                *ngFor=\"let collection of nestOptions\"\n                icon=\"bwi-collection\"\n                [value]=\"collection.name\"\n                [label]=\"collection.name\"\n              >\n              </bit-option>\n            </bit-select>\n          </bit-form-field>\n        </bit-tab>\n        <bit-tab label=\"{{ 'access' | i18n }}\">\n          <bit-access-selector\n            *ngIf=\"organization.useGroups\"\n            [permissionMode]=\"PermissionMode.Edit\"\n            formControlName=\"access\"\n            [items]=\"accessItems\"\n            [columnHeader]=\"'groupAndMemberColumnHeader' | i18n\"\n            [selectorLabelText]=\"'selectGroupsAndMembers' | i18n\"\n            [selectorHelpText]=\"'userPermissionOverrideHelper' | i18n\"\n            [emptySelectionText]=\"'noMembersOrGroupsAdded' | i18n\"\n          ></bit-access-selector>\n          <bit-access-selector\n            *ngIf=\"!organization.useGroups\"\n            [permissionMode]=\"PermissionMode.Edit\"\n            formControlName=\"access\"\n            [items]=\"accessItems\"\n            [columnHeader]=\"'memberColumnHeader' | i18n\"\n            [selectorLabelText]=\"'selectMembers' | i18n\"\n            [emptySelectionText]=\"'noMembersAdded' | i18n\"\n          ></bit-access-selector>\n        </bit-tab>\n      </bit-tab-group>\n    </div>\n    <ng-container bitDialogFooter>\n      <button type=\"submit\" bitButton bitFormButton buttonType=\"primary\" [disabled]=\"loading\">\n        {{ \"save\" | i18n }}\n      </button>\n      <button\n        type=\"button\"\n        bitButton\n        bitFormButton\n        buttonType=\"secondary\"\n        (click)=\"cancel()\"\n        [disabled]=\"loading\"\n      >\n        {{ \"cancel\" | i18n }}\n      </button>\n      <button\n        *ngIf=\"editMode && organization?.canDeleteAssignedCollections\"\n        type=\"button\"\n        bitIconButton=\"bwi-trash\"\n        buttonType=\"danger\"\n        class=\"tw-ml-auto\"\n        bitFormButton\n        [appA11yTitle]=\"'delete' | i18n\"\n        [bitAction]=\"delete\"\n        [disabled]=\"loading\"\n      ></button>\n    </ng-container>\n  </bit-dialog>\n</form>\n","import { AbstractControl, FormControl, ValidationErrors, ValidatorFn } from \"@angular/forms\";\n\nexport function forbiddenCharacters(characters: string[]): ValidatorFn {\n  return (control: AbstractControl): ValidationErrors | null => {\n    if (!(control instanceof FormControl)) {\n      throw new Error(\"forbiddenCharacters only supports validating FormControls\");\n    }\n\n    if (control.value === null || control.value === undefined) {\n      return null;\n    }\n\n    const value = String(control.value);\n\n    for (const char of value) {\n      if (characters.includes(char)) {\n        return { forbiddenCharacters: { value: control.value, characters } };\n      }\n    }\n\n    return null;\n  };\n}\n","import { NgModule } from \"@angular/core\";\n\nimport { SelectModule } from \"@bitwarden/components\";\n\nimport { AccessSelectorModule } from \"../../../../../admin-console/organizations/shared/components/access-selector/access-selector.module\";\nimport { SharedModule } from \"../../../../../shared\";\n\nimport { CollectionDialogComponent } from \"./collection-dialog.component\";\n\n@NgModule({\n  imports: [SharedModule, AccessSelectorModule, SelectModule],\n  declarations: [CollectionDialogComponent],\n  exports: [CollectionDialogComponent],\n})\nexport class CollectionDialogModule {}\n","import { NgModule } from \"@angular/core\";\n\nimport { SearchModule } from \"@bitwarden/components\";\n\nimport { SharedModule } from \"../../../shared/shared.module\";\n\nimport { AccessSelectorModule } from \"./components/access-selector/access-selector.module\";\nimport { CollectionDialogModule } from \"./components/collection-dialog\";\n\n@NgModule({\n  imports: [SharedModule, CollectionDialogModule, AccessSelectorModule, SearchModule],\n  declarations: [],\n  exports: [SharedModule, CollectionDialogModule, AccessSelectorModule, SearchModule],\n})\nexport class SharedOrganizationModule {}\n","<ng-select\n  [items]=\"baseItems\"\n  [(ngModel)]=\"selectedItems\"\n  (ngModelChange)=\"onChange($event)\"\n  (blur)=\"onBlur()\"\n  bindLabel=\"listName\"\n  groupBy=\"parentGrouping\"\n  [placeholder]=\"placeholder\"\n  [loading]=\"loading\"\n  [loadingText]=\"loadingText\"\n  notFoundText=\"{{ 'multiSelectNotFound' | i18n }}\"\n  clearAllText=\"{{ 'multiSelectClearAll' | i18n }}\"\n  [multiple]=\"true\"\n  [selectOnTab]=\"true\"\n  [closeOnSelect]=\"false\"\n  (close)=\"onDropdownClosed()\"\n  [disabled]=\"disabled\"\n  [clearSearchOnAdd]=\"true\"\n  [labelForId]=\"labelForId\"\n  [keyDownFn]=\"keyDown\"\n  appendTo=\"body\"\n>\n  <ng-template ng-loadingspinner-tmp>\n    <i class=\"bwi bwi-spinner bwi-spin tw-mr-1\" [title]=\"loadingText\" aria-hidden=\"true\"></i>\n  </ng-template>\n  <ng-template ng-label-tmp let-item=\"item\" let-clear=\"clear\">\n    <button\n      type=\"button\"\n      bitBadge\n      badgeType=\"primary\"\n      class=\"tw-mr-1 disabled:tw-border-0\"\n      [disabled]=\"disabled\"\n      (click)=\"clear(item)\"\n    >\n      <i\n        *ngIf=\"item.icon != null\"\n        class=\"tw-mr-1 bwi bwi-fw {{ item.icon }}\"\n        aria-hidden=\"true\"\n      ></i>\n      {{ item.labelName }}\n      <i class=\"bwi bwi-fw bwi-close bwi-sm tw-ml-1\" aria-hidden=\"true\"></i>\n    </button>\n  </ng-template>\n  <ng-template ng-option-tmp let-item=\"item\">\n    <div class=\"tw-flex\">\n      <div class=\"tw-w-7 tw-flex-none\">\n        <i *ngIf=\"isSelected(item)\" class=\"bwi bwi-fw bwi-check\" aria-hidden=\"true\"></i>\n      </div>\n      <div class=\"tw-mr-2 tw-flex-initial\">\n        <i *ngIf=\"item.icon != null\" class=\"bwi bwi-fw {{ item.icon }}\" aria-hidden=\"true\"></i>\n      </div>\n      <div class=\"tw-flex-1\">\n        {{ item.listName }}\n      </div>\n    </div>\n  </ng-template>\n</ng-select>\n","import { hasModifierKey } from \"@angular/cdk/keycodes\";\nimport {\n  Component,\n  Input,\n  OnInit,\n  Output,\n  ViewChild,\n  EventEmitter,\n  HostBinding,\n  Optional,\n  Self,\n} from \"@angular/core\";\nimport { ControlValueAccessor, NgControl, Validators } from \"@angular/forms\";\nimport { NgSelectComponent } from \"@ng-select/ng-select\";\n\nimport { I18nService } from \"@bitwarden/common/abstractions/i18n.service\";\n\nimport { BitFormFieldControl } from \"../form-field/form-field-control\";\n\nimport { SelectItemView } from \"./models/select-item-view\";\n\n// Increments for each instance of this component\nlet nextId = 0;\n\n@Component({\n  selector: \"bit-multi-select\",\n  templateUrl: \"./multi-select.component.html\",\n  providers: [{ provide: BitFormFieldControl, useExisting: MultiSelectComponent }],\n})\n/**\n * This component has been implemented to only support Multi-select list events\n */\nexport class MultiSelectComponent implements OnInit, BitFormFieldControl, ControlValueAccessor {\n  @ViewChild(NgSelectComponent) select: NgSelectComponent;\n\n  // Parent component should only pass selectable items (complete list - selected items = baseItems)\n  @Input() baseItems: SelectItemView[];\n  // Defaults to native ng-select behavior - set to \"true\" to clear selected items on dropdown close\n  @Input() removeSelectedItems = false;\n  @Input() placeholder: string;\n  @Input() loading = false;\n  @Input() disabled = false;\n\n  // Internal tracking of selected items\n  @Input() selectedItems: SelectItemView[];\n\n  // Default values for our implementation\n  loadingText: string;\n\n  protected searchInputId = `search-input-${nextId++}`;\n\n  /**Implemented as part of NG_VALUE_ACCESSOR */\n  private notifyOnChange?: (value: SelectItemView[]) => void;\n  /**Implemented as part of NG_VALUE_ACCESSOR */\n  private notifyOnTouched?: () => void;\n\n  @Output() onItemsConfirmed = new EventEmitter<any[]>();\n\n  constructor(private i18nService: I18nService, @Optional() @Self() private ngControl?: NgControl) {\n    if (ngControl != null) {\n      ngControl.valueAccessor = this;\n    }\n  }\n\n  ngOnInit(): void {\n    // Default Text Values\n    this.placeholder = this.placeholder ?? this.i18nService.t(\"multiSelectPlaceholder\");\n    this.loadingText = this.i18nService.t(\"multiSelectLoading\");\n  }\n\n  /** Function for customizing keyboard navigation */\n  /** Needs to be arrow function to retain `this` scope. */\n  keyDown = (event: KeyboardEvent) => {\n    if (!this.select.isOpen && event.key === \"Enter\" && !hasModifierKey(event)) {\n      return false;\n    }\n\n    if (this.select.isOpen && event.key === \"Enter\" && !hasModifierKey(event)) {\n      this.select.close();\n      event.preventDefault();\n      return false;\n    }\n\n    if (this.select.isOpen && event.key === \"Escape\" && !hasModifierKey(event)) {\n      this.selectedItems = [];\n      this.select.close();\n      event.stopPropagation();\n      return false;\n    }\n\n    return true;\n  };\n\n  /** Helper method for showing selected state in custom template */\n  isSelected(item: any): boolean {\n    return this.selectedItems?.find((selected) => selected.id === item.id) != undefined;\n  }\n\n  /**\n   * The `close` callback will act as the only trigger for signifying the user's intent of completing the selection\n   * of items. Selected items will be emitted to the parent component in order to allow for separate data handling.\n   */\n  onDropdownClosed(): void {\n    // Early exit\n    if (this.selectedItems == null || this.selectedItems.length == 0) {\n      return;\n    }\n\n    // Emit results to parent component\n    this.onItemsConfirmed.emit(this.selectedItems);\n\n    // Remove selected items from base list based on input property\n    if (this.removeSelectedItems) {\n      let updatedBaseItems = this.baseItems;\n      this.selectedItems.forEach((selectedItem) => {\n        updatedBaseItems = updatedBaseItems.filter((item) => selectedItem.id !== item.id);\n      });\n\n      // Reset Lists\n      this.selectedItems = null;\n      this.baseItems = updatedBaseItems;\n    }\n  }\n\n  /**Implemented as part of NG_VALUE_ACCESSOR */\n  writeValue(obj: SelectItemView[]): void {\n    this.selectedItems = obj;\n  }\n\n  /**Implemented as part of NG_VALUE_ACCESSOR */\n  registerOnChange(fn: (value: SelectItemView[]) => void): void {\n    this.notifyOnChange = fn;\n  }\n\n  /**Implemented as part of NG_VALUE_ACCESSOR */\n  registerOnTouched(fn: any): void {\n    this.notifyOnTouched = fn;\n  }\n\n  /**Implemented as part of NG_VALUE_ACCESSOR */\n  setDisabledState(isDisabled: boolean): void {\n    this.disabled = isDisabled;\n  }\n\n  /**Implemented as part of NG_VALUE_ACCESSOR */\n  protected onChange(items: SelectItemView[]) {\n    if (!this.notifyOnChange) {\n      return;\n    }\n\n    this.notifyOnChange(items);\n  }\n\n  /**Implemented as part of NG_VALUE_ACCESSOR */\n  protected onBlur() {\n    if (!this.notifyOnTouched) {\n      return;\n    }\n\n    this.notifyOnTouched();\n  }\n\n  /**Implemented as part of BitFormFieldControl */\n  @HostBinding(\"attr.aria-describedby\")\n  get ariaDescribedBy() {\n    return this._ariaDescribedBy;\n  }\n  set ariaDescribedBy(value: string) {\n    this._ariaDescribedBy = value;\n    this.select?.searchInput.nativeElement.setAttribute(\"aria-describedby\", value);\n  }\n  private _ariaDescribedBy: string;\n\n  /**Implemented as part of BitFormFieldControl */\n  get labelForId() {\n    return this.searchInputId;\n  }\n\n  /**Implemented as part of BitFormFieldControl */\n  @HostBinding() @Input() id = `bit-multi-select-${nextId++}`;\n\n  /**Implemented as part of BitFormFieldControl */\n  @HostBinding(\"attr.required\")\n  @Input()\n  get required() {\n    return this._required ?? this.ngControl?.control?.hasValidator(Validators.required) ?? false;\n  }\n  set required(value: any) {\n    this._required = value != null && value !== false;\n  }\n  private _required: boolean;\n\n  /**Implemented as part of BitFormFieldControl */\n  get hasError() {\n    return this.ngControl?.status === \"INVALID\" && this.ngControl?.touched;\n  }\n\n  /**Implemented as part of BitFormFieldControl */\n  get error(): [string, any] {\n    const key = Object.keys(this.ngControl?.errors)[0];\n    return [key, this.ngControl?.errors[key]];\n  }\n}\n","import { NgModule } from \"@angular/core\";\nimport { FormsModule } from \"@angular/forms\";\n\nimport { InputModule } from \"../input/input.module\";\nimport { SharedModule } from \"../shared\";\n\nimport { SearchComponent } from \"./search.component\";\n\n@NgModule({\n  imports: [SharedModule, InputModule, FormsModule],\n  declarations: [SearchComponent],\n  exports: [SearchComponent],\n})\nexport class SearchModule {}\n","import { TemplatePortal } from \"@angular/cdk/portal\";\nimport { Component, HostBinding, Input } from \"@angular/core\";\n\n@Component({\n  selector: \"bit-tab-body\",\n  templateUrl: \"tab-body.component.html\",\n})\nexport class TabBodyComponent {\n  private _firstRender: boolean;\n\n  @Input() content: TemplatePortal;\n  @Input() preserveContent = false;\n\n  @HostBinding(\"attr.hidden\") get hidden() {\n    return !this.active || null;\n  }\n\n  @Input()\n  get active() {\n    return this._active;\n  }\n  set active(value: boolean) {\n    this._active = value;\n    if (this._active) {\n      this._firstRender = true;\n    }\n  }\n  private _active: boolean;\n\n  /**\n   * The tab content to render.\n   * Inactive tabs that have never been rendered/active do not have their\n   * content rendered by default for performance. If `preserveContent` is `true`\n   * then the content persists after the first time content is rendered.\n   */\n  get tabContent() {\n    if (this.active) {\n      return this.content;\n    }\n    if (this.preserveContent && this._firstRender) {\n      return this.content;\n    }\n    return null;\n  }\n}\n","<bit-tab-header>\n  <div\n    bitTabListContainer\n    role=\"tablist\"\n    [attr.aria-label]=\"label\"\n    (keydown)=\"keyManager.onKeydown($event)\"\n  >\n    <button\n      bitTabListItem\n      *ngFor=\"let tab of tabs; let i = index\"\n      type=\"button\"\n      role=\"tab\"\n      [id]=\"getTabLabelId(i)\"\n      [active]=\"tab.isActive\"\n      [disabled]=\"tab.disabled\"\n      [attr.aria-selected]=\"selectedIndex === i\"\n      [attr.tabindex]=\"selectedIndex === i ? 0 : -1\"\n      (click)=\"selectTab(i)\"\n    >\n      <ng-container [ngTemplateOutlet]=\"content\"></ng-container>\n\n      <ng-template #content>\n        <ng-template [ngIf]=\"tab.templateLabel\" [ngIfElse]=\"tabTextLabel\">\n          <ng-container [ngTemplateOutlet]=\"tab.templateLabel.templateRef\"></ng-container>\n        </ng-template>\n\n        <ng-template #tabTextLabel>{{ tab.textLabel }}</ng-template>\n      </ng-template>\n    </button>\n  </div>\n</bit-tab-header>\n<div class=\"tw-px-4 tw-pt-5\">\n  <bit-tab-body\n    role=\"tabpanel\"\n    *ngFor=\"let tab of tabs; let i = index\"\n    [id]=\"getTabContentId(i)\"\n    [attr.tabindex]=\"tab.contentTabIndex\"\n    [attr.labeledby]=\"getTabLabelId(i)\"\n    [active]=\"tab.isActive\"\n    [content]=\"tab.content\"\n    [preserveContent]=\"preserveContent\"\n  >\n  </bit-tab-body>\n</div>\n","<ng-template [cdkPortalOutlet]=\"tabContent\"></ng-template>\n","import { FocusKeyManager } from \"@angular/cdk/a11y\";\nimport { coerceNumberProperty } from \"@angular/cdk/coercion\";\nimport {\n  AfterContentChecked,\n  AfterContentInit,\n  AfterViewInit,\n  Component,\n  ContentChildren,\n  EventEmitter,\n  Input,\n  OnDestroy,\n  Output,\n  QueryList,\n  ViewChildren,\n} from \"@angular/core\";\nimport { Subject, takeUntil } from \"rxjs\";\n\nimport { TabListItemDirective } from \"../shared/tab-list-item.directive\";\n\nimport { TabComponent } from \"./tab.component\";\n\n/** Used to generate unique ID's for each tab component */\nlet nextId = 0;\n\n@Component({\n  selector: \"bit-tab-group\",\n  templateUrl: \"./tab-group.component.html\",\n})\nexport class TabGroupComponent\n  implements AfterContentChecked, AfterContentInit, AfterViewInit, OnDestroy\n{\n  private readonly _groupId: number;\n  private readonly destroy$ = new Subject<void>();\n  private _indexToSelect: number | null = 0;\n\n  /**\n   * Aria label for the tab list menu\n   */\n  @Input() label = \"\";\n\n  /**\n   * Keep the content of off-screen tabs in the DOM.\n   * Useful for keeping <audio> or <video> elements from re-initializing\n   * after navigating between tabs.\n   */\n  @Input() preserveContent = false;\n\n  @ContentChildren(TabComponent) tabs: QueryList<TabComponent>;\n  @ViewChildren(TabListItemDirective) tabLabels: QueryList<TabListItemDirective>;\n\n  /** The index of the active tab. */\n  @Input()\n  get selectedIndex(): number | null {\n    return this._selectedIndex;\n  }\n  set selectedIndex(value: number) {\n    this._indexToSelect = coerceNumberProperty(value, null);\n  }\n  private _selectedIndex: number | null = null;\n\n  /** Output to enable support for two-way binding on `[(selectedIndex)]` */\n  @Output() readonly selectedIndexChange: EventEmitter<number> = new EventEmitter<number>();\n\n  /** Event emitted when the tab selection has changed. */\n  @Output() readonly selectedTabChange: EventEmitter<BitTabChangeEvent> =\n    new EventEmitter<BitTabChangeEvent>();\n\n  /**\n   * Focus key manager for keeping tab controls accessible.\n   * https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles/tablist_role#keyboard_interactions\n   */\n  keyManager: FocusKeyManager<TabListItemDirective>;\n\n  constructor() {\n    this._groupId = nextId++;\n  }\n\n  protected getTabContentId(id: number): string {\n    return `bit-tab-content-${this._groupId}-${id}`;\n  }\n\n  protected getTabLabelId(id: number): string {\n    return `bit-tab-label-${this._groupId}-${id}`;\n  }\n\n  selectTab(index: number) {\n    this.selectedIndex = index;\n  }\n\n  /**\n   * After content is checked, the tab group knows what tabs are defined and which index\n   * should be currently selected.\n   */\n  ngAfterContentChecked(): void {\n    const indexToSelect = (this._indexToSelect = this._clampTabIndex(this._indexToSelect));\n\n    if (this._selectedIndex != indexToSelect) {\n      const isFirstRun = this._selectedIndex == null;\n\n      if (!isFirstRun) {\n        this.selectedTabChange.emit({\n          index: indexToSelect,\n          tab: this.tabs.toArray()[indexToSelect],\n        });\n      }\n\n      // These values need to be updated after change detection as\n      // the checked content may have references to them.\n      Promise.resolve().then(() => {\n        this.tabs.forEach((tab, index) => (tab.isActive = index === indexToSelect));\n\n        if (!isFirstRun) {\n          this.selectedIndexChange.emit(indexToSelect);\n        }\n      });\n\n      // Manually update the _selectedIndex and keyManager active item\n      this._selectedIndex = indexToSelect;\n      if (this.keyManager) {\n        this.keyManager.setActiveItem(indexToSelect);\n      }\n    }\n  }\n\n  ngAfterViewInit(): void {\n    this.keyManager = new FocusKeyManager(this.tabLabels)\n      .withHorizontalOrientation(\"ltr\")\n      .withWrap()\n      .withHomeAndEnd();\n  }\n\n  ngAfterContentInit() {\n    // Subscribe to any changes in the number of tabs, in order to be able\n    // to re-render content when new tabs are added or removed.\n    this.tabs.changes.pipe(takeUntil(this.destroy$)).subscribe(() => {\n      const indexToSelect = this._clampTabIndex(this._indexToSelect);\n\n      // If the selected tab didn't explicitly change, keep the previously\n      // selected tab selected/active\n      if (indexToSelect === this._selectedIndex) {\n        const tabs = this.tabs.toArray();\n        let selectedTab: TabComponent | undefined;\n\n        for (let i = 0; i < tabs.length; i++) {\n          if (tabs[i].isActive) {\n            // Set both _indexToSelect and _selectedIndex to avoid firing a change\n            // event which could cause an infinite loop if adding a tab within the\n            // selectedIndexChange event\n            this._indexToSelect = this._selectedIndex = i;\n            selectedTab = tabs[i];\n            break;\n          }\n        }\n\n        // No active tab found and a tab does exist means the active tab\n        // was removed, so a new active tab must be set manually\n        if (!selectedTab && tabs[indexToSelect]) {\n          tabs[indexToSelect].isActive = true;\n          this.selectedTabChange.emit({\n            index: indexToSelect,\n            tab: tabs[indexToSelect],\n          });\n        }\n      }\n    });\n  }\n\n  ngOnDestroy() {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n\n  private _clampTabIndex(index: number): number {\n    return Math.min(this.tabs.length - 1, Math.max(index || 0, 0));\n  }\n}\n\nexport class BitTabChangeEvent {\n  /**\n   * The currently selected tab index\n   */\n  index: number;\n  /**\n   * The currently selected tab\n   */\n  tab: TabComponent;\n}\n","import { Directive, TemplateRef } from \"@angular/core\";\n\n/**\n * Used to identify template based tab labels (allows complex labels instead of just plaintext)\n *\n * @example\n * ```\n * <bit-tab>\n *   <ng-template bitTabLabel>\n *     <i class=\"bwi bwi-search\"></i> Search\n *   </ng-template>\n *\n *   <p>Tab Content</p>\n * </bit-tab>\n * ```\n */\n@Directive({\n  selector: \"[bitTabLabel]\",\n})\nexport class TabLabelDirective {\n  constructor(public templateRef: TemplateRef<unknown>) {}\n}\n","<ng-template><ng-content></ng-content></ng-template>\n","import { TemplatePortal } from \"@angular/cdk/portal\";\nimport {\n  Component,\n  ContentChild,\n  Input,\n  OnInit,\n  TemplateRef,\n  ViewChild,\n  ViewContainerRef,\n} from \"@angular/core\";\n\nimport { TabLabelDirective } from \"./tab-label.directive\";\n\n@Component({\n  selector: \"bit-tab\",\n  templateUrl: \"./tab.component.html\",\n  host: {\n    role: \"tabpanel\",\n  },\n})\nexport class TabComponent implements OnInit {\n  @Input() disabled = false;\n  @Input(\"label\") textLabel = \"\";\n\n  /**\n   * Optional tabIndex for the tabPanel that contains this tab's content.\n   *\n   * If the tabpanel does not contain any focusable elements or the first element with content is not focusable,\n   * this should be set to 0 to include it in the tab sequence of the page.\n   *\n   * @remarks See note 4 of https://www.w3.org/WAI/ARIA/apg/patterns/tabpanel/\n   */\n  @Input() contentTabIndex: number | undefined;\n\n  @ViewChild(TemplateRef, { static: true }) implicitContent: TemplateRef<unknown>;\n  @ContentChild(TabLabelDirective) templateLabel: TabLabelDirective;\n\n  private _contentPortal: TemplatePortal | null = null;\n\n  get content(): TemplatePortal | null {\n    return this._contentPortal;\n  }\n\n  isActive: boolean;\n\n  constructor(private _viewContainerRef: ViewContainerRef) {}\n\n  ngOnInit(): void {\n    this._contentPortal = new TemplatePortal(this.implicitContent, this._viewContainerRef);\n  }\n}\n"],"names":["OrganizationRedirectGuard","constructor","router","organizationService","canActivate","route","state","org","this","get","params","organizationId","customRedirect","data","autoRedirectCallback","redirectPath","createUrlTree","url","id","GroupAddEditTabType","GroupAddEditDialogResultType","GroupAddEditComponent","groupId","orgCollections$","from","apiService","getCollections","pipe","switchMap","response","collectionService","decryptMany","map","r","collections","c","type","labelName","name","listName","orgMembers$","organizationUserService","getAllUsers","m","email","role","length","status","groupDetails$","editMode","combineLatest","groupService","getGroupUsers","groupView","users","members","catchError","e","logService","error","message","toString","of","undefined","dialogRef","i18nService","platformUtilsService","formBuilder","changeDetectorRef","dialogService","PermissionMode","ResultType","loading","groupForm","group","accessAll","externalId","control","value","disabled","destroy$","Subject","submit","markAllAsTouched","invalid","tabIndex","Info","showToast","t","formValue","save","close","Saved","delete","openSimpleDialog","title","content","key","Deleted","initialTab","ngOnInit","takeUntil","subscribe","detectChanges","patchValue","gc","permission","ngOnDestroy","next","complete","check","edit","loadMore","toggleAllVisible","deleteAllSelected","GroupsComponent","searchText","_searchText","updateSearchedGroups","visibleGroups","isPaging","pagedGroups","isSearching","searchedGroups","groups","modalService","searchService","searchPipe","didScroll","pageSize","ModalTabType","pagedGroupsCount","refreshGroups$","BehaviorSubject","tap","concatMap","toCollectionMap","getAll","collectionMap","sort","g","details","checked","collectionNames","collator","compare","resetPaging","queryParams","first","qParams","search","pagedLength","pagedSize","concat","slice","startingTabIndex","config","open","result","lastValueFrom","closed","removeGroup","add","groupRow","groupsToDelete","filter","deleteMessage","join","placeholders","deleteMany","forEach","isSearchable","event","target","searching","index","findIndex","splice","decryptedCollections","transform","VaultFilterService","stateService","folderService","cipherService","policyService","collectionAdminService","super","_collections","ReplaySubject","filteredCollections$","asObservable","collectionTree$","buildCollectionTree","reloadCollections","VaultFilterModule","provide","useClass","reupload","download","AttachmentsComponent","cryptoService","fileDownloadService","viewOnly","attachment","organization","canEditAnyCollection","showFixOldAttachments","reuploadCipherAttachment","loadCipher","getCipherAdmin","cipherId","saveCipherAttachment","file","saveAttachmentWithServer","cipherDomain","deleteCipherAttachment","attachmentId","deleteCipherAttachmentAdmin","selectAll","CollectionsComponent","allowSelectNone","canViewAllCollections","loadCipherCollections","collectionIds","loadCollections","Promise","resolve","saveCollections","request","putCipherCollectionsAdmin","onSearchTextChanged","VaultFilterComponent","_organization","vaultFilterService","setOrganizationFilter","filters","buildAllFilters","activeFilter","selectedCipherTypeNode","resetFilter","selectedCollectionNode","getDefaultFilter","isLoaded","builderFilter","typeFilter","addTypeFilter","collectionFilter","addCollectionFilter","trashFilter","addTrashFilter","firstValueFrom","data$","editCollection","deleteCollection","addCipher","addCollection","VaultHeaderComponent","All","Unassigned","onAddCipher","onAddCollection","onEditCollection","onDeleteCollection","CollectionDialogTabType","organizations$","collection","node","collectionId","toLowerCase","showBreadcrumbs","parent","push","reverse","treeNode","showFreeOrgUpgradeDialog","orgUpgradeSimpleDialogOpts","canEditSubscription","maxCollections","acceptButtonText","cancelButtonText","simpleDialog","openSimpleDialogRef","then","navigate","upgrade","canEditCollection","canEditAssignedCollections","assigned","emit","planProductType","tab","canDeleteCollection","canDeleteAnyCollection","canDeleteAssignedCollections","BroadcasterSubscriptionId","VaultComponent","routedVaultFilterBridgeService","routedVaultFilterService","syncService","messagingService","broadcasterService","ngZone","passwordRepromptService","eventCollectionService","totpService","trashCleanupWarning","noItemIcon","performingInitialLoad","refreshing","processingEvent","searchText$","refresh$","isSelfHost","filter$","organizationId$","distinctUntilChanged","organization$","get$","shareReplay","refCount","bufferSize","firstSetup$","canUseAdminCollections","fullSync","run","command","successfully","refresh","activeFilter$","debounceTime","queryParamsHandling","replaceUrl","currentSearchText$","allCollectionsWithoutUnassigned$","orgId","allCollections$","allCollections","noneCollection","allGroups$","allCiphers$","ciphers","getAllFromApiForOrganization","getAllDecrypted","indexCiphers","ciphers$","filterFunction","searchCiphers","nestedCollections$","collections$","collectionsToReturn","selectedCollection","children","selectedCollection$","showMissingCollectionPermissionMessage$","getCipherIdFromParams","editCipherId","itemId","viewEvents","cipher","find","useEvents","allGroups","showMissingCollectionPermissionMessage","isEmpty","unsubscribe","onVaultItemsEvent","editCipherAttachments","item","editCipherCollections","cloneCipher","items","restore","bulkRestore","i","deleteCipher","bulkDelete","copy","field","filterSearchText","maxStorageGb","send","madeAttachmentChanges","modal","openViewRef","attachmentsModalRef","comp","onUploadedAttachment","onDeletedAttachment","onClosed","currCollections","collectionsModalRef","readOnly","onSavedCollections","editCipher","cipherType","navigateToCipher","go","additionalComponentParameters","reprompt","showPasswordPrompt","defaultComponentParameters","onSavedCipher","onDeletedCipher","onRestoredCipher","childComponent","cipherAddEditModalRef","onClosedPromise","cloneMode","repromptCipher","isDeleted","asAdmin","restoreWithServer","selectedCipherIds","dialog","cipherIds","permanent","deleteCipherWithServer","aType","typeI18nKey","login","username","password","getCode","totp","protectedFields","includes","viewPassword","copyToClipboard","window","collect","parentCollectionId","eventsModalRef","entityId","showUser","entity","deleteWithServer","softDeleteWithServer","notProtected","deleted","relativeTo","routes","path","component","titleId","organizationPermissions","VaultRoutingModule","VaultModule","pathMatch","loadChildren","OrganizationSettingsModule","MembersModule","OrganizationReportingModule","OrganizationBillingModule","OrganizationsRoutingModule","OrganizationModule","findSortedIndex","sortedArray","val","compareFn","low","high","mid","Math","floor","FormSelectionList","controlFactory","allItems","selectedItems","deselectedItems","formArray","selectItems","ids","initialValue","selectItem","deselectItems","deselectItem","deselectAll","clear","o","selectedOption","sortedInsertIndex","newControl","insert","deselectedOption","removeAt","populateItems","selectedItem","forEachControlItem","fn","at","UserTypePipe","unknownText","handleBlur","selectionList","AccessSelectorComponent","selected","getRawValue","readonly","icon","itemIcon","permissionMode","_permissionMode","updateAllRowControlDisableStates","updateRowControlDisableState","controlRow","disable","enable","accessAllItems","Edit","controls","permissionControl","initialPermission","fg","_itemComparator","bind","formGroup","itemType","permissionList","perm","labelId","Hidden","registerOnChange","notifyOnChange","registerOnTouched","notifyOnTouch","setDisabledState","isDisabled","writeValue","pauseChangeNotification","Array","isArray","Error","valueChanges","v","permissionLabelId","p","accessAllLabelId","canEditItemPermission","a","b","Number","useExisting","multi","CollectionPermission","AccessItemType","convertToPermission","hidePasswords","ViewExceptPass","View","EditExceptPass","convertToSelectionView","hidePassword","AccessSelectorModule","CollectionDialogResult","CollectionDialogComponent","characters","nestOptions","accessItems","String","char","forbiddenCharacters","access","Access","collectionView","groups$","useGroups","collectionDetails","mapGroupToAccessItemView","mapUserToAccessItemView","nameParts","split","parseName","deletedParentName","accessSelections","selection","mapToAccessSelections","cancel","Canceled","user","openCollectionDialog","CollectionDialogModule","SharedOrganizationModule","nextId","MultiSelectComponent","ngControl","removeSelectedItems","searchInputId","onItemsConfirmed","keyDown","select","isOpen","preventDefault","stopPropagation","valueAccessor","placeholder","loadingText","isSelected","onDropdownClosed","updatedBaseItems","baseItems","obj","notifyOnTouched","onChange","onBlur","ariaDescribedBy","_ariaDescribedBy","searchInput","nativeElement","setAttribute","labelForId","required","_required","hasValidator","hasError","touched","Object","keys","errors","SearchModule","TabBodyComponent","preserveContent","hidden","active","_active","_firstRender","tabContent","selectTab","TabGroupComponent","selectedIndex","_selectedIndex","_indexToSelect","label","selectedIndexChange","selectedTabChange","_groupId","getTabContentId","getTabLabelId","ngAfterContentChecked","indexToSelect","_clampTabIndex","isFirstRun","tabs","toArray","isActive","keyManager","setActiveItem","ngAfterViewInit","tabLabels","withHorizontalOrientation","withWrap","withHomeAndEnd","ngAfterContentInit","changes","selectedTab","min","max","TabLabelDirective","templateRef","TabComponent","_contentPortal","_viewContainerRef","textLabel","implicitContent"],"sourceRoot":""}