<!-- TODO: Rewrite and refactor this component when implementing the new design -->
<ng-container *ngIf="data$ | async as data">
  <div class="auth-wrapper">
    <div class="logo-image"></div>
    <ng-container *ngIf="data.showUnsupportedVerification">
      {{ "passkeyFeatureIsNotImplementedForAccountsWithoutMasterPassword" | i18n }}
    </ng-container>
    <ng-container *ngIf="!data.showUnsupportedVerification">
      <ng-container
        *ngIf="
          data.message.type == 'PickCredentialRequest' ||
          data.message.type == 'ConfirmNewNonDiscoverableCredentialRequest'
        "
      >
        <div class="auth-flow">
          <p class="subtitle">{{ pickCredentialSubTitleText | i18n }}</p>
          <div class="box list">
            <div class="box-content">
              <app-fido2-cipher-row
                *ngFor="let cipher of ciphers"
                [cipher]="cipher"
                (onSelected)="selectedPasskey($event)"
              ></app-fido2-cipher-row>
            </div>
          </div>
          <div class="box">
            <button type="submit" (click)="pick()" class="btn primary block">
              <span [hidden]="loading">{{ "confirm" | i18n }}</span>
              <i class="bwi bwi-spinner bwi-lg bwi-spin" [hidden]="!loading" aria-hidden="true"></i>
            </button>
          </div>
        </div>
      </ng-container>
      <ng-container *ngIf="data.message.type == 'ConfirmNewCredentialRequest'">
        <div class="auth-flow">
          <p class="subtitle">{{ "SavePasskeyInBitwarden" | i18n }}</p>
          <div class="box list">
            <div class="box-content">
              <app-fido2-cipher-row [cipher]="ciphers[0]"></app-fido2-cipher-row>
            </div>
          </div>
          <button type="button" class="btn primary block" (click)="confirm()">
            <span [hidden]="loading">{{ "savePasskey" | i18n }}</span>
            <i class="bwi bwi-spinner bwi-lg bwi-spin" [hidden]="!loading" aria-hidden="true"></i>
          </button>
        </div>
      </ng-container>
      <ng-container *ngIf="data.message.type == 'InformExcludedCredentialRequest'">
        <div class="auth-flow">
          <p class="subtitle">{{ "passkeyAlreadyExistsInBitwardenForThisAccount" | i18n }}</p>
          <div class="box list">
            <div class="box-content">
              <app-fido2-cipher-row
                *ngFor="let cipher of ciphers"
                [cipher]="cipher"
              ></app-fido2-cipher-row>
            </div>
          </div>
          <button type="button" class="btn primary block" (click)="viewPasskey()">
            <span [hidden]="loading">{{ "viewPasskey" | i18n }}</span>
            <i class="bwi bwi-spinner bwi-lg bwi-spin" [hidden]="!loading" aria-hidden="true"></i>
          </button>
        </div>
      </ng-container>
      <ng-container *ngIf="data.message.type == 'InformCredentialNotFoundRequest'">
        <div class="auth-flow">
          <p class="subtitle">{{ "noPasskeysFoundForThisApplication" | i18n }}</p>
        </div>
      </ng-container>
    </ng-container>
    <a *ngIf="data.fallbackSupported" (click)="abort(true)">
      {{ "useBrowserName" | i18n }} browser
    </a>
  </div>
</ng-container>
